<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head>
	<title>Visual TreeCmp: Comparison of Phylogenetic Trees on the Web</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" />
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" />
	<link rel="stylesheet" th:href="@{css/treecmp.css}" type="text/css" />

	<style>
		.form-group .item{white-space: nowrap; display:inline}
	</style>

	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="js/ww.jquery.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.6/d3.min.js"></script>
    <script src="js/navigation.js"></script>
	<script src="js/treecompare.js"></script>

</head>
<body>

	<nav class="navbar navbar-default navbar-fixed-top">
		<div class="container-fluid">
			<div class="navbar-header">
				<button type="button" class="navbar-toggle collapsed"
						data-toggle="collapse"
						data-target="#mainmenu"
						aria-expanded="false">
					<span class="sr-only">Navigation switch</span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
				</button>
				<a class="navbar-logo" href="https://eti.pg.edu.pl/treecmp/">
					<img alt="TreeCmp" width="50" height="50" src="img/treecmp_logo.png" />
				</a>
			</div>

			<div class="collapse navbar-collapse" id="mainmenu">
				<ul class="nav navbar-nav">
					<li class="active"><a href="WEB">Main page</a></li>
					<li><a href="report">Report</a></li>
					<!--<li><a href="report">Report</a></li>-->
				</ul>
				<ul class="nav navbar-nav navbar-right">
					<li><a href="manual_tree_cmp.html"><span class="glyphicon glyphicon-question-sign" aria-hidden="true"></span></a></li>
					<li><a href="about_tree_cmp.html"><span class="glyphicon glyphicon glyphicon-info-sign" aria-hidden="true"></span></a></li>
				</ul>
			</div>
		</div>
	</nav>

	<!-- END OF NAVIGATION BAR -->
	<!-- MAIN CONTAINER -->
	<div class="container-fluid">

		<form id="form" method="post" th:object="${newickStringNew}" th:action="@{/report}">
			<div class="row">
				<div class="col-xs-12 col-xs-offset-0 col-lg-offset-1 main">
					<div class="form-group">
						<div class="radio">
							<label>
								<input type="radio" th:field="*{comparisionMode}" id="rbOverlapping" value="-s" onclick="HideSecondWindowAndHideNumberInput();"/>
								Overlapping pair comparison
							</label>
						</div>
                        <div class="radio">
                            <label>
                                <input type="radio" th:field="*{comparisionMode}" id="rbWindow" value="-w" onclick="HideSecondWindowAndShowNumberInput();"/>
                                Window comparison
                                <input type="number" th:field="*{windowWidth}" id="rbWindowWidthInput" min="2" max="99" value="2"/>
                            </label>
                        </div>
                        <div class="radio">
                            <label>
                                <input type="radio" th:field="*{comparisionMode}" id="rbMatrix" value="-m" onclick="HideSecondWindowAndHideNumberInput();"/>
                                Matrix comparison
                            </label>
                        </div>
						<div class="radio">
							<label>
								<input type="radio" th:field="*{comparisionMode}" id="rbRefToAll" value="-r" onclick="ShowSecondWindowAndHideNumberInput();"/>
								Ref-to-all comparison
							</label>
						</div>
						<div style="margin-left: 15px;">
							<errors th:errors="*{comparisionMode}" class="error" />
						</div>
					</div>

					<div class="form-group">
						<div class="row placeholders">
							<div class="col-xs-12 col-md-6 col-lg-5" id="firstTreeText" style="display: none">
								<table class="fixed smallMargin" style="display: block;">
									<tbody>
									<tr class="row1">
										<td><b>Newick trees:</b></td>
										<td class="sidebar-version" style="...">
											<input type="text" class="treename" for="newickInputFirstFile" id="newickInputFirstLabel" rows="1" placeholder="Untitled" />
										</td>
										<td align="right">
											<input class="smallMargin" id="newickInputFirstFile" type="file" style="display:none" />
											<button class="btn btn-xs smallMargin" id="newickInputFirstButton" type="button">
												<span class="glyphicon glyphicon-file"></span>
											</button>
										</td>
									</tr>
									</tbody>
								</table>
								<textarea th:field="*{newickStringFirst}" class="form-control"
											   rows="14" id="newickInputFirst"
											   placeholder="Paste or drag and drop your trees in newick format separated by ;" style="resize: none;"></textarea>
								<div>
									<errors th:errors="*{newickStringFirst}" class="error" />
								</div>
								<div>
									<errors class="error" id="renderErrorMessage1"/>
								</div>

                                <div>
                                    <label>Examples:</label>
                                    <div class="exampleBtn singleIn" id="addFirstExmpTrees" style="display:inline-block;">
                                        <a href="#" data-toggle="tooltip" data-placement="top" title="Example trees stored in Nexus format.">
                                            #1
                                        </a>
                                    </div>
                                    <div class="exampleBtn singleIn" id="addSecondExmpTrees" style="display:inline-block;">
                                        <a href="#" data-toggle="tooltip" data-placement="top" title="Bird trees (6 trees with &lt;= 17 leaves each) obtained based on different markers from S.V. Edwards, A. Cloutier, A. J. Baker, &quot;Conserved Nonexonic Elements: A Novel Class of Marker for Phylogenomics&quot;, Systematic Biology 66(6):1028–1044, 2017, https://doi.org/10.1093/sysbio/syx058">
                                            #2
                                        </a>
                                    </div>
                                    <div class="exampleBtn singleIn" id="addThirdExmpTrees" style="display:inline-block;">
                                        <a href="#" data-toggle="tooltip" data-placement="top" title="Seabird supertrees (2 trees, 122 leaves including outgroup): Adams consensus and strict consensus from M. Kennedy, R. D. M. Page, &quot;Seabird supertrees: Combining partial estimates of procellariiform phylogeny&quot;, The Auk 119(1):88–108, 2002, https://treebase.org/treebase-web/search/study/trees.html?id=853">
                                            #3
                                        </a>
                                    </div>
                                    <div class="exampleBtn singleIn" id="addFourthExmpTrees" style="display:inline-block;">
                                        <a href="#" data-toggle="tooltip" data-placement="top" title="Seabird supertrees obtained using different methods (6 supertrees wich 121 leaves as ref-trees, 7 source trees with the number of leaves between 14 and 90) from C. Whidden, N. Zeh, R. G. Beiko, &quot;Supertrees Based on the Subtree Prune-and-Regraft Distance&quot;, Systematic Biology, 63(4):566-581, 2014, https://doi.org/10.1093/sysbio/syu023">
                                            #4
                                        </a>
                                    </div>
                                </div>

							</div>
							<div class="col-xs-12 col-md-6 col-lg-5" id="secondTreeText" style="display: none">
								<table class="fixed smallMargin" style="display: block;">
									<tbody>
									<tr class="row1">
										<td><b>Newick trees:</b></td>
										<td class="sidebar-version" style="...">
											<input type="text" class="treename" for="newickInputSecondFile" id="newickInputSecondLabel" rows="1" placeholder="Untitled" />
										</td>
										<td align="right">
											<input class="smallMargin" id="newickInputSecondFile" type="file" style="display:none" />
											<button class="btn btn-xs smallMargin" id="newickInputSecondButton" type="button">
												<span class="glyphicon glyphicon-file"></span>
											</button>
										</td>
									</tr>
									</tbody>
								</table>
								<textarea th:field="*{newickStringSecond}" class="form-control"
											   rows="14" id="newickInputSecond"
											   placeholder="Paste or drag and drop your trees in newick format separated by ;" style="resize: none;"></textarea>
								<div>
									<errors th:errors="*{newickStringSecond}" class="error" />
								</div>
                                <div>
                                    <errors class="error" id="renderErrorMessage2"/>
                                </div>
							</div>

							<!--SETTINGS SECTION-->
							<div class="col-xs-12 col-lg-10">
								<!--METRICS AND OTHER OPTIONS PANEL-->
								<div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">
									<div class="panel panel-default">
										<div class="panel-heading" role="tab" id="infoBox1">
											<h4 class="panel-title">
												<a data-toggle="collapse" data-parent="#accordion" href="#collapse1" aria-expanded="true" aria-controls="collapse1">
													Rooted metrics
												</a>
											</h4>
										</div>
										<div id="collapse1" class="panel-collapse collapse" role="tabpanel" aria-labelledby="infoBox1">
											<div class="panel-body">
												<div class="form-group">
													<div th:each="item, stat : ${rootedMetrics}">
														<input type="checkbox" th:field="*{rootedMetrics}" th:value="${item.key}" />
														<span data-toggle="tooltip" data-placement="top"  th:attr="title=${item.value.fullDescription}" th:text="${item.value.fullname}"/>
													</div>
												</div>
											</div>
										</div>
										<div class="panel-heading" role="tab" id="infoBox2">
											<h4 class="panel-title">
												<a data-toggle="collapse" data-parent="#accordion" href="#collapse2" aria-expanded="true" aria-controls="collapse2">
													Unrooted metrics
												</a>
											</h4>
										</div>
										<div id="collapse2" class="panel-collapse collapse" role="tabpanel" aria-labelledby="infoBox2">
											<div class="panel-body">
												<div class="form-group">
													<div th:each="item, stat : ${unrootedMetrics}">
														<input type="checkbox" th:field="*{unrootedMetrics}" th:value="${item.key}"  />
														<span data-toggle="tooltip" data-placement="top"  th:attr="title=${item.value.fullDescription}" th:text="${item.value.fullname}"/>
													</div>
												</div>
											</div>
										</div>
									</div>
									<div>
										<errors th:errors="*{hasMetrics}" class="error" />
									</div>
									<div class="panel panel-default">
										<div class="panel-heading" role="tab" id="infoBox3">
											<h4 class="panel-title">
												<a data-toggle="collapse" data-parent="#accordion" href="#collapse3" aria-expanded="true" aria-controls="collapse3">
													Other options
												</a>
											</h4>
										</div>
										<div id="collapse3" class="panel-collapse collapse" role="tabpanel" aria-labelledby="infoBox3">
											<div class="panel-body">
												<div>
													<input type="checkbox" th:field="*{normalizedDistances}" id="opNormDis" />
                                                    <span data-toggle="tooltip" data-placement="top" title="Reporting distances divided by pre-computed empirical average values for random trees (generated according to Yule and uniform models) can help in an interpretation of the similarity level of analyzed trees in chosen metric.">
                                                        Normalized distances
                                                    </span>
												</div>
												<div>
													<input type="checkbox" th:field="*{pruneTrees}" id="opPrTrees" />
                                                    <span data-toggle="tooltip" data-placement="top" title="Prune compared trees if needed. This option is design to allow comparing trees having different (partially overlapping) sets of taxa. After using this option three additional columns appear in report table.">
                                                        Prune trees
                                                    </span>
												</div>
												<div>
													<input type="checkbox" th:field="*{includeSummary}" id="opInclSum" />
                                                    <span data-toggle="tooltip" data-placement="top" title="Include additional summary section with data computed based on all rows that appears in report table.">
                                                        Include summary
                                                    </span>
                                                </div>
											</div>
										</div>
									</div>
								</div>
								<!--END OF METRICS AND OTHER OPTIONS PANEL-->
							</div>
							<!--END OF SETTINGS SECTION-->
						</div>
					</div>
					<div class="form-group">
						<button type="submit" class="btn btn-primary">Compute</button>
					</div>
				</div>
			</div>
		</form>

        <div id="WaitDialog" class="hidden" style="text-align: center">
            <img  src="img/spinner.gif" />
            <div style="margin-top: 10px; color: white">
                <b>Please wait</b>
            </div>
        </div>

	</div>

	<!-- FOOTER -->
	<div class="row footer">
		<div class="col-xs-12 text-center">
			Gdansk University of Technology &copy; 2018
		</div>
	</div>
	<!-- END OF FOOTER -->

</body>

<script type="text/javascript">

    $("#form").submit(function() {
        $("body").css("cursor", "wait");
        var wd = document.getElementById("WaitDialog");
        wd.classList.remove("hidden");
        $("#WaitDialog").modalDialog();
    });

    $("#addFirstExmpTrees").click(function() {
        $("#newickInputFirst").val("#nexus\n" +
            "begin trees;\n" +
            "  tree_one = (15:0.100000,(10:0.100000,(((((12:0.100000,(14:0.100000,4:0.100000):0.100000):0.100000,13:0.100000):0.100000,9:0.100000):0.100000,(2:0.100000,11:0.100000):0.100000):0.100000,(6:0.100000,(8:0.100000,((7:0.100000,5:0.100000):0.100000,3:0.100000):0.100000):0.100000):0.100000):0.100000):0.100000,1:0.100000);\n" +
            "  tree_two = ((4:0.150544,((((11:0.065873,13:0.116382):0.033734,12:0.030332):0.040636,15:0.100000):0.033699,14:0.191842):0.130937):0.054639,((8:0.062614,(7:0.125118,(10:0.112016,9:0.148703):0.031571):0.249102):0.041360,((3:0.120344,2:0.100000):0.040487,(5:0.198900,6:0.133571):0.076557):0.044130):0.033153,1:0.191819);\n" +
            "  tree_three = ((3:0.088858,2:0.100767):0.025391,((6:0.211435,(4:0.091527,5:0.125414):0.021078):0.075315,(((8:0.081965,((((11:0.040791,13:0.116382):0.058415,12:0.032032):0.042032,15:0.100000):0.027826,14:0.083684):0.092429):0.053057,(10:0.112651,9:0.125479):0.148942):0.044990,7:0.125118):0.075954):0.113318,1:0.256537);\n" +
            "  tree_four = ((3:0.094620,2:0.124501):0.023625,((6:0.176744,(4:0.062987,5:0.082446):0.081879):0.074894,(((8:0.081965,(15:0.078628,(((11:0.040791,13:0.078948):0.026857,12:0.021683):0.030356,14:0.074846):0.027642):0.110277):0.038606,(10:0.126379,9:0.125479):0.140897):0.053657,7:0.174578):0.078200):0.065308,1:0.770047);\n" +
            "  tree_five = (((6:0.144838,(4:0.056811,5:0.067155):0.103577):0.053721,(((8:0.081965,(10:0.095842,9:0.126998):0.085727):0.032698,(15:0.075916,(((11:0.003119,13:0.078948):0.065246,12:0.021683):0.030678,14:0.068527):0.022510):0.119957):0.017605,7:0.174578):0.097452):0.078951,(3:0.065666,2:0.198511):0.019047,1:0.770047);\n" +
            "end;");
        $("#newickInputFirstLabel").val('');
        $("#newickInputSecond").val("#nexus\n" +
            "begin trees;\n" +
            "  tree_six = (((6:0.173548,(4:0.038265,5:0.049616):0.116198):0.088332,(((8:0.107641,(10:0.072825,9:0.046683):0.066314):0.001909,(15:0.060254,(((11:0.036049,13:0.053570):0.033983,12:0.012624):0.058759,14:0.046727):0.001344):0.117593):0.015950,7:0.174578):0.074823):0.078951,(3:0.067359,2:0.228438):0.016452,1:0.517132);\n" +
            "  tree_seven = (((6:0.093545,(4:0.037183,5:0.049616):0.132727):0.073544,(((8:0.107641,(((13:0.079625,(11:0.036049,12:0.006391):0.003710):0.040924,15:0.043925):0.000917,14:0.033768):0.117593):0.015950,7:0.174578):0.002374,(10:0.072825,9:0.060455):0.077398):0.074823):0.053716,(3:0.067359,2:0.228438):0.016452,1:0.517132);\n" +
            "end;");
        $("#newickInputSecondLabel").val('');
        $("#rbRefToAll").click();
    });

    $("#addSecondExmpTrees").click(function() {
        $("#newickInputFirst").val("((((((((Zebra_finch,Golden-collared_manakin),Peregrine_falcon),Bald_eagle),Downy_woodpecker),((Adelie_penguin,Red-throated_loon),(Great_crested_grebe,American_flamingo))),((Chicken,Turkey),Duck)),(((White-throated_tinamou,Chilean_tinamou),Emu),Ostrich)),Alligator);\n" +
            "(((((((Zebra_finch,Golden-collared_manakin),Peregrine_falcon),(Downy_woodpecker,Bald_eagle)),(Adelie_penguin,Red-throated_loon)),(Great_crested_grebe,American_flamingo)),((Chicken,Turkey),Duck)),(White-throated_tinamou,Ostrich));\n" +
            "((((((((Zebra_finch,Golden-collared_manakin),Peregrine_falcon),Downy_woodpecker),Bald_eagle),((Adelie_penguin,Red-throated_loon),(Great_crested_grebe,American_flamingo))),((Chicken,Turkey),Duck)),(((White-throated_tinamou,Chilean_tinamou),Emu),Ostrich)),Alligator);\n" +
            "((((((((Zebra_finch,Golden-collared_manakin),Peregrine_falcon),Downy_woodpecker),Bald_eagle),(Adelie_penguin,Red-throated_loon)),(Great_crested_grebe,American_flamingo)),((Chicken,Turkey),Duck)),(White-throated_tinamou,Ostrich));\n" +
            "(((((((Zebra_finch,Golden-collared_manakin),Peregrine_falcon),Downy_woodpecker),Bald_eagle),((Adelie_penguin,Red-throated_loon),(Great_crested_grebe,American_flamingo))),((Chicken,Turkey),Duck)),(White-throated_tinamou,Ostrich));\n" +
            "((((((((Zebra_finch,Golden-collared_manakin),Peregrine_falcon),Downy_woodpecker),Bald_eagle),((Adelie_penguin,Red-throated_loon),(Great_crested_grebe,American_flamingo))),((Chicken,Turkey),Duck)),(((White-throated_tinamou,Chilean_tinamou),Emu),Ostrich)),Alligator);");
        $("#newickInputFirstLabel").val('');
        $("#newickInputSecond").val("");
        $("#newickInputSecondLabel").val('');
        $("#opPrTrees").prop("checked", true);
        $("#rbMatrix").click();
    });

    $("#addThirdExmpTrees").click(function() {
        $("#newickInputFirst").val("(outgroup_to_Procellariiformes_MRP,((((((((((((((((Puffinus_puffinus,(Puffinus_yelkouan,Puffinus_mauretanicus)),(Puffinus_lherminieri,Puffinus_assimilis),Puffinus_opisthomelas),Puffinus_auricularis,(Puffinus_huttoni,Puffinus_gavia)),Puffinus_nativitatis),(Calonectris_diomedea,Calonectris_leucomelas)),((Puffinus_pacificus,Puffinus_bulleri),Puffinus_tenuirostris,(Puffinus_griseus,Puffinus_gravis,(Puffinus_carneipes,Puffinus_creatopus)))),(Pseudobulweria_aterrima,Pseudobulweria_rostrata)),(Bulweria_bulwerii,((Procellaria_aequinoctialis,Procellaria_parkinsoni),Procellaria_westlandica)),Procellaria_cinerea),(Halobaena_caerulea,((Pachyptila_vittata,(Pachyptila_salvini,Pachyptila_desolata)),Pachyptila_turtur)),Lugensa_brevirostris),(((((Fulmarus_glacialis,Fulmarus_glacialoides),(Macronectes_giganteus,Macronectes_halli)),Daption_capense),Thalassoica_antarctica),Pagodroma_nivea)),(((Pterodroma_nigripennis,Pterodroma_cervicalis),Pterodroma_axillaris),(((((((Pterodroma_baraui,Pterodroma_arminjoniana),(Pterodroma_externa,Pterodroma_neglecta)),((Pterodroma_phaeopygia,Pterodroma_sandwichensis),Pterodroma_heraldica)),Pterodroma_alba),Pterodroma_inexpectata),((((Pterodroma_feae,Pterodroma_madeira),Pterodroma_mollis,(Pterodroma_cahow,Pterodroma_hasitata),Pterodroma_incerta,Pterodroma_lessonii,Pterodroma_magentae,Pterodroma_macroptera),Pterodroma_solandri),Pterodroma_ultima)),((Pterodroma_pycrofti,Pterodroma_longirostris),(Pterodroma_brevipes,(Pterodroma_leucoptera,(Pterodroma_cookii,Pterodroma_defilippiana)))),Pterodroma_hypoleuca))),((Pelecanoides_urinatrix,(Pelecanoides_georgicus,Pelecanoides_magellani)),Pelecanoides_garnotii)),((((((Diomedea_exulans,Diomedea_amsterdamensis),(Diomedea_gibsoni,Diomedea_antipodensis)),Diomedea_dabbenena),(Diomedea_epomophora,Diomedea_sanfordi)),((Phoebastria_albatrus,(Phoebastria_immutabilis,Phoebastria_nigripes)),Phoebastria_irrorata)),((((Thalassarche_bulleri,(Thalassarche_cauta,(Thalassarche_eremita,Thalassarche_salvini))),(Thalassarche_chrysostoma,(Thalassarche_melanophris,Thalassarche_impavida))),(Thalassarche_chlororhynchos,Thalassarche_bassi)),(Phoebetria_fusca,Phoebetria_palpebrata)))),(((Oceanodroma_leucorhoa,Oceanodroma_tristrami),(Hydrobates_pelagicus,Oceanodroma_furcata)),Oceanodroma_castro,((Halocyptena_microsoma,Oceanodroma_tethys),Oceanodroma_melania),Oceanodroma_hornbyi),(((Pelagodroma_marina,Garrodia_nereis),(Fregetta_tropica,Fregetta_grallaria)),Oceanites_oceanicus))Procellariidae,(Gavia_immer,Gavia_stellata)Gaviidae),((Aptenodytes_patagonicus,(Eudyptes_chrysocome,Eudyptes_chrysolophus)),(Pygoscelis_papua,Pygoscelis_antarctica,((Megadyptes_antipodes,Eudyptes_pachyrhynchus),(Eudyptula_minor,Spheniscus_demersus))),Pygoscelis_adeliae)Spheniscidae));\n" +
		"(outgroup_to_Procellariiformes_MRP,((((((((((((Puffinus_puffinus,Puffinus_auricularis,Puffinus_lherminieri,Puffinus_assimilis,(Puffinus_huttoni,Puffinus_gavia),Puffinus_yelkouan,Puffinus_mauretanicus,Puffinus_opisthomelas),Puffinus_nativitatis),(Calonectris_diomedea,Calonectris_leucomelas)),((Puffinus_pacificus,Puffinus_bulleri),Puffinus_tenuirostris,Puffinus_griseus,Puffinus_gravis,(Puffinus_carneipes,Puffinus_creatopus))),Bulweria_bulwerii,Pseudobulweria_aterrima,Pseudobulweria_rostrata,Procellaria_cinerea,(Halobaena_caerulea,((Pachyptila_vittata,(Pachyptila_salvini,Pachyptila_desolata)),Pachyptila_turtur)),Procellaria_aequinoctialis,Procellaria_parkinsoni,Procellaria_westlandica,Lugensa_brevirostris),(((((Fulmarus_glacialis,Fulmarus_glacialoides),(Macronectes_giganteus,Macronectes_halli)),Daption_capense),Thalassoica_antarctica),Pagodroma_nivea)),(((Pterodroma_nigripennis,Pterodroma_cervicalis),Pterodroma_axillaris),(((((((Pterodroma_baraui,Pterodroma_arminjoniana),(Pterodroma_externa,Pterodroma_neglecta)),((Pterodroma_phaeopygia,Pterodroma_sandwichensis),Pterodroma_heraldica)),Pterodroma_alba),Pterodroma_inexpectata),((((Pterodroma_feae,Pterodroma_madeira),Pterodroma_mollis,(Pterodroma_cahow,Pterodroma_hasitata),Pterodroma_incerta,Pterodroma_lessonii,Pterodroma_magentae,Pterodroma_macroptera),Pterodroma_solandri),Pterodroma_ultima)),((Pterodroma_pycrofti,Pterodroma_longirostris),(Pterodroma_brevipes,(Pterodroma_leucoptera,(Pterodroma_cookii,Pterodroma_defilippiana)))),Pterodroma_hypoleuca))),((Pelecanoides_urinatrix,(Pelecanoides_georgicus,Pelecanoides_magellani)),Pelecanoides_garnotii)),((((((Diomedea_exulans,Diomedea_amsterdamensis),(Diomedea_gibsoni,Diomedea_antipodensis)),Diomedea_dabbenena),(Diomedea_epomophora,Diomedea_sanfordi)),((Phoebastria_albatrus,(Phoebastria_immutabilis,Phoebastria_nigripes)),Phoebastria_irrorata)),((((Thalassarche_bulleri,(Thalassarche_cauta,(Thalassarche_eremita,Thalassarche_salvini))),(Thalassarche_chrysostoma,(Thalassarche_melanophris,Thalassarche_impavida))),(Thalassarche_chlororhynchos,Thalassarche_bassi)),(Phoebetria_fusca,Phoebetria_palpebrata)))),Oceanodroma_leucorhoa,Oceanodroma_castro,Hydrobates_pelagicus,Pelagodroma_marina,Garrodia_nereis,Fregetta_tropica,Oceanites_oceanicus,Oceanodroma_tristrami,Oceanodroma_furcata,Halocyptena_microsoma,Oceanodroma_tethys,Oceanodroma_melania,Fregetta_grallaria,Oceanodroma_hornbyi)Procellariidae,(Gavia_immer,Gavia_stellata)Gaviidae),(Aptenodytes_patagonicus,Eudyptes_chrysocome,Eudyptes_chrysolophus,Pygoscelis_papua,Pygoscelis_antarctica,Megadyptes_antipodes,Eudyptes_pachyrhynchus,Eudyptula_minor,Pygoscelis_adeliae,Spheniscus_demersus)Spheniscidae));");
        $("#newickInputFirstLabel").val('');
        $("#newickInputSecond").val("");
        $("#newickInputSecondLabel").val('');
        $("#rbMatrix").click();
    });

    $("#addFourthExmpTrees").click(function() {
        $("#newickInputFirst").val("((((Puffinus_puffinus, Puffinus_auricularis, Puffinus_lherminieri, Puffinus_assimilis, (Puffinus_huttoni, Puffinus_gavia), (Puffinus_yelkouan, Puffinus_mauretanicus)), Puffinus_nativitatis), ((Puffinus_pacificus, Puffinus_bulleri), Puffinus_tenuirostris, Puffinus_griseus, Puffinus_gravis, (Puffinus_carneipes, Puffinus_creatopus))), Fulmarus_glacialis);\n" +
            "((Diomedea_exulans, Oceanodroma_leucorhoa), (Pelecanoides_urinatrix, ((((Bulweria_bulwerii, Procellaria_cinerea), ((Calonectris_diomedea, Puffinus_pacificus), (Pseudobulweria_aterrima, Pseudobulweria_rostrata))), ((Fulmarus_glacialis, Macronectes_giganteus), Pagodroma_nivea)), (Pterodroma_nigripennis, Pterodroma_baraui))));\n" +
            "((Oceanodroma_castro, Hydrobates_pelagicus), (((Macronectes_giganteus, (Fulmarus_glacialoides, Fulmarus_glacialis)), (Bulweria_bulwerii, (((Puffinus_assimilis, (Puffinus_puffinus, (Puffinus_yelkouan, Puffinus_mauretanicus))), Calonectris_diomedea), Procellaria_cinerea))), (((Thalassarche_bulleri, Thalassarche_chrysostoma), (Phoebetria_fusca, Phoebetria_palpebrata)), ((Phoebastria_albatrus, Phoebastria_immutabilis), (Diomedea_amsterdamensis, Diomedea_epomophora)))));\n" +
            "((((((((Pterodroma_baraui, Pterodroma_arminjoniana), (Pterodroma_externa, Pterodroma_neglecta)), ((Pterodroma_phaeopygia, Pterodroma_sandwichensis), Pterodroma_heraldica)), Pterodroma_alba), ((((((((Pterodroma_feae, Pterodroma_madeira), Pterodroma_mollis), (((Pterodroma_cahow, Pterodroma_hasitata), Pterodroma_incerta), Pterodroma_lessonii)), Pterodroma_magentae), Pterodroma_macroptera), Pterodroma_solandri), Pterodroma_ultima), Pterodroma_inexpectata)), ((Pterodroma_pycrofti, Pterodroma_longirostris), (Pterodroma_brevipes, (Pterodroma_leucoptera, (Pterodroma_cookii, Pterodroma_defilippiana))))), Pterodroma_hypoleuca), ((Pterodroma_cervicalis, Pterodroma_nigripennis), Pterodroma_axillaris));\n" +
            "((((((((Thalassarche_chlororhynchus, Thalassarche_bassi), ((Thalassarche_bulleri, (Thalassarche_cauta, (Thalassarche_eremita, Thalassarche_salvini))), (Thalassarche_chrysostoma, (Thalassarche_melanophris, Thalassarche_impavida)))), (Phoebetria_palpebrata, Phoebetria_fusca)), (((((Diomedea_amsterdamensis, Diomedea_exulans), (Diomedea_gibsoni, Diomedea_antipodensis)), Diomedea_dabbenena), (Diomedea_sanfordi, Diomedea_epomophora)), (((Phoebastria_immutabilis, Phoebastria_nigripes), Phoebastria_albatrus), Phoebastria_irrorata))), ((((((((Macronectes_giganteus, Macronectes_halli), (Fulmarus_glacialis, Fulmarus_glacialoides)), Daption_capense), Thalassoica_antarctica), Pagodroma_nivea), (((Halobaena_caerulea, ((Pachyptila_vittata, (Pachyptila_salvini, Pachyptila_desolata)), Pachyptila_turtur)), (((Procellaria_aequinoctialis, Procellaria_parkinsoni), Procellaria_westlandica), Bulweria_bulwerii)), (((((Puffinus_huttoni, ((Puffinus_lherminieri, Puffinus_assimilis), Puffinus_puffinus, Puffinus_opisthomelas)), Puffinus_nativitatis), (Calonectris_diomedea, Calonectris_leucomelas)), ((Puffinus_bulleri, Puffinus_pacificus), (Puffinus_griseus, Puffinus_gravis, (Puffinus_carneipes, Puffinus_creatopus)))), Lugensa_brevirostris))), ((((((Pterodroma_hasitata, (Pterodroma_feae, Pterodroma_cahow)), ((Pterodroma_incerta, (Pterodroma_macroptera, Pterodroma_lessonii)), Pterodroma_magentae)), Pterodroma_mollis), (Pterodroma_neglecta, ((Pterodroma_externa, Pterodroma_phaeopygia), Pterodroma_inexpectata))), ((Pterodroma_cookii, Pterodroma_longirostris), Pterodroma_hypoleuca)), Pterodroma_nigripennis)), ((Pelecanoides_urinatrix, (Pelecanoides_georgicus, Pelecanoides_magellani)), Pelecanoides_garnotii))), (((Pelagodroma_marina, Garrodia_nereis), (Fregetta_tropica, Fregetta_grallaria)), Oceanites_oceanicus)), (((Oceanodroma_tristrami, Oceanodroma_leucorhoa), (Oceanodroma_furcata, Hydrobates_pelagicus)), ((Halocyptena_microsoma, Oceanodroma_tethys), Oceanodroma_melania))), ((Aptenodytes_patagonicus, (Eudyptes_chrysocome, Eudyptes_chrysolophus)), (Pygoscelis_papua, Pygoscelis_antarctica)));\n" +
            "((((Megadyptes_antipodes, Eudyptes_pachyrhynchus), Eudyptula_minor), Pygoscelis_adeliae), (((Diomedea_epomophora, Thalassarche_bulleri), Pelagodroma_marina), (Daption_capense, ((Pelecanoides_georgicus, (Pachyptila_vittata, Pachyptila_turtur)), (((Puffinus_griseus, Puffinus_huttoni), Procellaria_westlandica), (Pterodroma_inexpectata, Pterodroma_cookii))))));\n" +
            "(((((Eudyptula_minor, Spheniscus_demersus), Megadyptes_antipodes), Pygoscelis_papua), Aptenodytes_patagonicus), ((Gavia_immer, Gavia_stellata), ((Oceanites_oceanicus, (Oceanodroma_furcata, Oceanodroma_hornbyi, Oceanodroma_leucorhoa)), (((Pelecanoides_urinatrix, Pelecanoides_georgicus), (Macronectes_giganteus, ((Lugensa_brevirostris, (Pterodroma_cookii, Pterodroma_hypoleuca, Pterodroma_arminjoniana, Pterodroma_hasitata)), (Pachyptila_vittata, Thalassoica_antarctica, (Puffinus_griseus, Calonectris_diomedea))))), (Thalassarche_bulleri, Thalassarche_cauta, Thalassarche_chrysostoma, (Phoebastria_nigripes, (Phoebastria_irrorata, (Diomedea_epomophora, Phoebastria_immutabilis))))))));\n");
        $("#newickInputFirstLabel").val('');
        $("#newickInputSecond").val("(((((((((((((((((((Puffinus_puffinus,(Puffinus_yelkouan,Puffinus_mauretanicus)),(Puffinus_lherminieri,Puffinus_assimilis)),Puffinus_opisthomelas),Puffinus_auricularis),(Puffinus_huttoni,Puffinus_gavia)),Puffinus_nativitatis),(Calonectris_diomedea,Calonectris_leucomelas)),(((Puffinus_pacificus,Puffinus_bulleri),Puffinus_tenuirostris),((Puffinus_griseus,Puffinus_gravis),(Puffinus_carneipes,Puffinus_creatopus)))),Lugensa_brevirostris),(Pseudobulweria_aterrima,Pseudobulweria_rostrata)),(((Bulweria_bulwerii,Procellaria_cinerea),((Procellaria_aequinoctialis,Procellaria_parkinsoni),Procellaria_westlandica)),(Halobaena_caerulea,((Pachyptila_vittata,(Pachyptila_salvini,Pachyptila_desolata)),Pachyptila_turtur)))),(((((Fulmarus_glacialis,Fulmarus_glacialoides),(Macronectes_giganteus,Macronectes_halli)),Daption_capense),Thalassoica_antarctica),Pagodroma_nivea)),(((Pterodroma_nigripennis,Pterodroma_cervicalis),Pterodroma_axillaris),(((((((Pterodroma_baraui,Pterodroma_arminjoniana),(Pterodroma_externa,Pterodroma_neglecta)),((Pterodroma_phaeopygia,Pterodroma_sandwichensis),Pterodroma_heraldica)),Pterodroma_alba),((((((((Pterodroma_feae,Pterodroma_madeira),Pterodroma_mollis),(((Pterodroma_cahow,Pterodroma_hasitata),Pterodroma_incerta),Pterodroma_lessonii)),Pterodroma_magentae),Pterodroma_macroptera),Pterodroma_solandri),Pterodroma_ultima),Pterodroma_inexpectata)),((Pterodroma_pycrofti,Pterodroma_longirostris),(Pterodroma_brevipes,(Pterodroma_leucoptera,(Pterodroma_cookii,Pterodroma_defilippiana))))),Pterodroma_hypoleuca))),((Pelecanoides_urinatrix,(Pelecanoides_georgicus,Pelecanoides_magellani)),Pelecanoides_garnotii)),((((((Diomedea_exulans,Diomedea_amsterdamensis),(Diomedea_gibsoni,Diomedea_antipodensis)),Diomedea_dabbenena),(Diomedea_epomophora,Diomedea_sanfordi)),((Phoebastria_albatrus,(Phoebastria_immutabilis,Phoebastria_nigripes)),Phoebastria_irrorata)),((((Thalassarche_bulleri,(Thalassarche_cauta,(Thalassarche_eremita,Thalassarche_salvini))),(Thalassarche_chrysostoma,(Thalassarche_melanophris,Thalassarche_impavida))),(Thalassarche_chlororhynchus,Thalassarche_bassi)),(Phoebetria_fusca,Phoebetria_palpebrata)))),(((Pelagodroma_marina,Garrodia_nereis),(Fregetta_tropica,Fregetta_grallaria)),Oceanites_oceanicus)),((((Oceanodroma_leucorhoa,Oceanodroma_hornbyi),Oceanodroma_tristrami),((Oceanodroma_castro,Hydrobates_pelagicus),Oceanodroma_furcata)),((Halocyptena_microsoma,Oceanodroma_tethys),Oceanodroma_melania))),(Gavia_immer,Gavia_stellata)),((Aptenodytes_patagonicus,(Eudyptes_chrysocome,Eudyptes_chrysolophus)),((Pygoscelis_papua,Pygoscelis_antarctica),(((Megadyptes_antipodes,Eudyptes_pachyrhynchus),(Eudyptula_minor,Spheniscus_demersus)),Pygoscelis_adeliae))));\n" +
            "((((Eudyptes_chrysolophus,Eudyptes_chrysocome),Aptenodytes_patagonicus),((Pygoscelis_antarctica,Pygoscelis_papua),(Pygoscelis_adeliae,((Eudyptes_pachyrhynchus,Megadyptes_antipodes),(Spheniscus_demersus,Eudyptula_minor))))),(((((((((Phoebastria_nigripes,Phoebastria_immutabilis),Phoebastria_albatrus),Phoebastria_irrorata),((Diomedea_dabbenena,((Diomedea_amsterdamensis,Diomedea_exulans),(Diomedea_antipodensis,Diomedea_gibsoni))),(Diomedea_sanfordi,Diomedea_epomophora))),((Phoebetria_fusca,Phoebetria_palpebrata),((Thalassarche_chlororhynchus,Thalassarche_bassi),((Thalassarche_bulleri,(Thalassarche_cauta,(Thalassarche_eremita,Thalassarche_salvini))),(Thalassarche_chrysostoma,(Thalassarche_impavida,Thalassarche_melanophris)))))),((Pelecanoides_garnotii,((Pelecanoides_georgicus,Pelecanoides_magellani),Pelecanoides_urinatrix)),(((Pterodroma_axillaris,(Pterodroma_cervicalis,Pterodroma_nigripennis)),((((Pterodroma_inexpectata,(Pterodroma_ultima,(Pterodroma_solandri,(Pterodroma_macroptera,(Pterodroma_magentae,(((Pterodroma_feae,Pterodroma_madeira),Pterodroma_mollis),(Pterodroma_lessonii,((Pterodroma_cahow,Pterodroma_hasitata),Pterodroma_incerta)))))))),((((Pterodroma_sandwichensis,Pterodroma_phaeopygia),Pterodroma_heraldica),((Pterodroma_externa,Pterodroma_neglecta),(Pterodroma_baraui,Pterodroma_arminjoniana))),Pterodroma_alba)),((Pterodroma_pycrofti,Pterodroma_longirostris),(Pterodroma_brevipes,(Pterodroma_leucoptera,(Pterodroma_defilippiana,Pterodroma_cookii))))),Pterodroma_hypoleuca)),((((Pseudobulweria_aterrima,Pseudobulweria_rostrata),((((Calonectris_leucomelas,Calonectris_diomedea),(((Puffinus_huttoni,Puffinus_gavia),(Puffinus_auricularis,(Puffinus_opisthomelas,((Puffinus_lherminieri,Puffinus_assimilis),((Puffinus_mauretanicus,Puffinus_yelkouan),Puffinus_puffinus))))),Puffinus_nativitatis)),(((Puffinus_creatopus,Puffinus_carneipes),(Puffinus_griseus,Puffinus_gravis)),(Puffinus_tenuirostris,(Puffinus_pacificus,Puffinus_bulleri)))),Lugensa_brevirostris)),(((Procellaria_cinerea,Bulweria_bulwerii),((Procellaria_aequinoctialis,Procellaria_parkinsoni),Procellaria_westlandica)),(Halobaena_caerulea,(Pachyptila_turtur,(Pachyptila_vittata,(Pachyptila_desolata,Pachyptila_salvini)))))),(((Daption_capense,((Macronectes_halli,Macronectes_giganteus),(Fulmarus_glacialis,Fulmarus_glacialoides))),Thalassoica_antarctica),Pagodroma_nivea))))),(((Pelagodroma_marina,Garrodia_nereis),(Fregetta_tropica,Fregetta_grallaria)),Oceanites_oceanicus)),((((Oceanodroma_hornbyi,Oceanodroma_leucorhoa),Oceanodroma_tristrami),(Oceanodroma_furcata,(Oceanodroma_castro,Hydrobates_pelagicus))),((Halocyptena_microsoma,Oceanodroma_tethys),Oceanodroma_melania))),(Gavia_stellata,Gavia_immer)));\n" +
            "(((((((((((((((((((Puffinus_puffinus,(Puffinus_yelkouan,Puffinus_mauretanicus)),(Puffinus_lherminieri,Puffinus_assimilis)),Puffinus_opisthomelas),Puffinus_auricularis),(Puffinus_huttoni,Puffinus_gavia)),Puffinus_nativitatis),(Calonectris_diomedea,Calonectris_leucomelas)),(((Puffinus_pacificus,Puffinus_bulleri),Puffinus_tenuirostris),((Puffinus_griseus,Puffinus_gravis),(Puffinus_carneipes,Puffinus_creatopus)))),Lugensa_brevirostris),(Pseudobulweria_aterrima,Pseudobulweria_rostrata)),(((Bulweria_bulwerii,Procellaria_cinerea),((Procellaria_aequinoctialis,Procellaria_parkinsoni),Procellaria_westlandica)),(Halobaena_caerulea,((Pachyptila_vittata,(Pachyptila_salvini,Pachyptila_desolata)),Pachyptila_turtur)))),(((((Fulmarus_glacialis,Fulmarus_glacialoides),(Macronectes_giganteus,Macronectes_halli)),Daption_capense),Thalassoica_antarctica),Pagodroma_nivea)),(((Pterodroma_nigripennis,Pterodroma_cervicalis),Pterodroma_axillaris),(((((((Pterodroma_baraui,Pterodroma_arminjoniana),(Pterodroma_externa,Pterodroma_neglecta)),((Pterodroma_phaeopygia,Pterodroma_sandwichensis),Pterodroma_heraldica)),Pterodroma_alba),((((((((Pterodroma_feae,Pterodroma_madeira),Pterodroma_mollis),(((Pterodroma_cahow,Pterodroma_hasitata),Pterodroma_incerta),Pterodroma_lessonii)),Pterodroma_magentae),Pterodroma_macroptera),Pterodroma_solandri),Pterodroma_ultima),Pterodroma_inexpectata)),((Pterodroma_pycrofti,Pterodroma_longirostris),(Pterodroma_brevipes,(Pterodroma_leucoptera,(Pterodroma_cookii,Pterodroma_defilippiana))))),Pterodroma_hypoleuca))),((Pelecanoides_urinatrix,(Pelecanoides_georgicus,Pelecanoides_magellani)),Pelecanoides_garnotii)),((((((Diomedea_exulans,Diomedea_amsterdamensis),(Diomedea_gibsoni,Diomedea_antipodensis)),Diomedea_dabbenena),(Diomedea_epomophora,Diomedea_sanfordi)),((Phoebastria_albatrus,(Phoebastria_immutabilis,Phoebastria_nigripes)),Phoebastria_irrorata)),((((Thalassarche_bulleri,(Thalassarche_cauta,(Thalassarche_eremita,Thalassarche_salvini))),(Thalassarche_chrysostoma,(Thalassarche_melanophris,Thalassarche_impavida))),(Thalassarche_chlororhynchus,Thalassarche_bassi)),(Phoebetria_fusca,Phoebetria_palpebrata)))),(((Pelagodroma_marina,Garrodia_nereis),(Fregetta_tropica,Fregetta_grallaria)),Oceanites_oceanicus)),((((Oceanodroma_leucorhoa,Oceanodroma_hornbyi),Oceanodroma_tristrami),((Oceanodroma_castro,Hydrobates_pelagicus),Oceanodroma_furcata)),((Halocyptena_microsoma,Oceanodroma_tethys),Oceanodroma_melania))),(Gavia_immer,Gavia_stellata)),((Aptenodytes_patagonicus,(Eudyptes_chrysocome,Eudyptes_chrysolophus)),((Pygoscelis_papua,Pygoscelis_antarctica),(((Megadyptes_antipodes,Eudyptes_pachyrhynchus),(Eudyptula_minor,Spheniscus_demersus)),Pygoscelis_adeliae))));\n" +
            "(((((Eudyptula_minor,(Spheniscus_demersus,Pygoscelis_antarctica)),(Megadyptes_antipodes,Eudyptes_pachyrhynchus)),(Pygoscelis_papua,Pygoscelis_adeliae)),(Aptenodytes_patagonicus,(Eudyptes_chrysolophus,Eudyptes_chrysocome))),(((((Daption_capense,(Oceanodroma_leucorhoa,Oceanodroma_tristrami)),((Oceanodroma_furcata,(Hydrobates_pelagicus,Oceanodroma_hornbyi)),Diomedea_exulans)),((Oceanites_oceanicus,Oceanodroma_melania),((Oceanodroma_tethys,Halocyptena_microsoma),Oceanodroma_castro))),(((((Phoebastria_irrorata,((Phoebastria_immutabilis,Phoebastria_nigripes),Phoebastria_albatrus)),((Diomedea_epomophora,Diomedea_sanfordi),(Diomedea_dabbenena,(Diomedea_amsterdamensis,(Diomedea_antipodensis,Diomedea_gibsoni))))),((Phoebetria_palpebrata,Phoebetria_fusca),(((Thalassarche_bulleri,(Thalassarche_cauta,(Thalassarche_salvini,Thalassarche_eremita))),(Thalassarche_chrysostoma,(Thalassarche_impavida,Thalassarche_melanophris))),(Thalassarche_bassi,Thalassarche_chlororhynchus)))),((((((Bulweria_bulwerii,(Procellaria_westlandica,(Procellaria_parkinsoni,Procellaria_aequinoctialis))),((Pachyptila_turtur,(Pachyptila_vittata,(Pachyptila_desolata,Pachyptila_salvini))),(Procellaria_cinerea,Halobaena_caerulea))),((((Puffinus_griseus,(((Puffinus_creatopus,Puffinus_carneipes),Puffinus_gravis),Puffinus_tenuirostris)),(Puffinus_pacificus,Puffinus_bulleri)),((((((Puffinus_puffinus,((Puffinus_mauretanicus,Puffinus_yelkouan),Puffinus_opisthomelas)),(Puffinus_assimilis,Puffinus_lherminieri)),Puffinus_auricularis),(Puffinus_huttoni,Puffinus_gavia)),Puffinus_nativitatis),(Calonectris_diomedea,Calonectris_leucomelas))),(Pseudobulweria_rostrata,Pseudobulweria_aterrima))),((((Fulmarus_glacialis,Fulmarus_glacialoides),(Macronectes_giganteus,Macronectes_halli)),Thalassoica_antarctica),Pagodroma_nivea)),(((Pterodroma_hypoleuca,(((Pterodroma_ultima,((((Pterodroma_macroptera,(Pterodroma_magentae,((Pterodroma_lessonii,Pterodroma_incerta),(Pterodroma_feae,Pterodroma_madeira)))),(Pterodroma_hasitata,Pterodroma_cahow)),Pterodroma_mollis),Pterodroma_solandri)),(((Pterodroma_inexpectata,(Pterodroma_externa,(Pterodroma_heraldica,(Pterodroma_phaeopygia,Pterodroma_sandwichensis)))),(Pterodroma_neglecta,(Pterodroma_arminjoniana,Pterodroma_baraui))),Pterodroma_alba)),((((Pterodroma_cookii,Pterodroma_defilippiana),Pterodroma_leucoptera),Pterodroma_brevipes),(Pterodroma_longirostris,Pterodroma_pycrofti)))),Lugensa_brevirostris),(Pterodroma_axillaris,(Pterodroma_nigripennis,Pterodroma_cervicalis)))),((Pelecanoides_urinatrix,(Pelecanoides_georgicus,Pelecanoides_magellani)),Pelecanoides_garnotii))),((Fregetta_grallaria,Fregetta_tropica),(Pelagodroma_marina,Garrodia_nereis)))),(Gavia_stellata,Gavia_immer)));\n" +
            "(((Pygoscelis_papua,(((Eudyptula_minor,(Spheniscus_demersus,Pygoscelis_antarctica)),(Megadyptes_antipodes,Eudyptes_pachyrhynchus)),Pygoscelis_adeliae)),(Aptenodytes_patagonicus,(Eudyptes_chrysolophus,Eudyptes_chrysocome))),((((((Phoebastria_irrorata,((Phoebastria_immutabilis,Phoebastria_nigripes),Phoebastria_albatrus)),((Diomedea_epomophora,Diomedea_sanfordi),(Diomedea_dabbenena,((Diomedea_amsterdamensis,Diomedea_exulans),(Diomedea_antipodensis,Diomedea_gibsoni))))),((Phoebetria_palpebrata,Phoebetria_fusca),(((Thalassarche_bulleri,(Thalassarche_cauta,(Thalassarche_salvini,Thalassarche_eremita))),(Thalassarche_chrysostoma,(Thalassarche_impavida,Thalassarche_melanophris))),(Thalassarche_bassi,Thalassarche_chlororhynchus)))),((((((Bulweria_bulwerii,(Procellaria_westlandica,(Procellaria_parkinsoni,Procellaria_aequinoctialis))),((Pachyptila_turtur,(Pachyptila_vittata,(Pachyptila_desolata,Pachyptila_salvini))),Halobaena_caerulea)),((Procellaria_cinerea,((((Puffinus_griseus,((Puffinus_creatopus,Puffinus_carneipes),Puffinus_gravis)),((Puffinus_pacificus,Puffinus_bulleri),Puffinus_tenuirostris)),(((((Puffinus_puffinus,((Puffinus_mauretanicus,Puffinus_yelkouan),Puffinus_opisthomelas)),(Puffinus_lherminieri,(Puffinus_assimilis,Puffinus_auricularis))),(Puffinus_huttoni,Puffinus_gavia)),Puffinus_nativitatis),(Calonectris_diomedea,Calonectris_leucomelas))),(Pseudobulweria_rostrata,Pseudobulweria_aterrima))),Lugensa_brevirostris)),((Thalassoica_antarctica,(((Fulmarus_glacialis,Fulmarus_glacialoides),(Macronectes_giganteus,Macronectes_halli)),Daption_capense)),Pagodroma_nivea)),(((Pterodroma_hypoleuca,((((Pterodroma_cookii,Pterodroma_defilippiana),Pterodroma_leucoptera),Pterodroma_brevipes),(Pterodroma_longirostris,Pterodroma_pycrofti))),((Pterodroma_inexpectata,(Pterodroma_ultima,((Pterodroma_macroptera,(Pterodroma_magentae,((Pterodroma_lessonii,(Pterodroma_incerta,(Pterodroma_hasitata,Pterodroma_cahow))),(Pterodroma_mollis,(Pterodroma_feae,Pterodroma_madeira))))),Pterodroma_solandri))),(((Pterodroma_externa,(Pterodroma_heraldica,(Pterodroma_phaeopygia,Pterodroma_sandwichensis))),(Pterodroma_neglecta,(Pterodroma_arminjoniana,Pterodroma_baraui))),Pterodroma_alba))),(Pterodroma_axillaris,(Pterodroma_nigripennis,Pterodroma_cervicalis)))),((Pelecanoides_urinatrix,(Pelecanoides_georgicus,Pelecanoides_magellani)),Pelecanoides_garnotii))),((Oceanites_oceanicus,((Fregetta_grallaria,Fregetta_tropica),(Pelagodroma_marina,Garrodia_nereis))),(((Hydrobates_pelagicus,(Oceanodroma_furcata,Oceanodroma_hornbyi)),(Oceanodroma_leucorhoa,Oceanodroma_tristrami)),((Oceanodroma_tethys,Halocyptena_microsoma),(Oceanodroma_melania,Oceanodroma_castro))))),(Gavia_stellata,Gavia_immer)));\n" +
            "(((((((((((Lugensa_brevirostris,(((Puffinus_nativitatis,((Puffinus_auricularis,(Puffinus_opisthomelas,((Puffinus_puffinus,(Puffinus_yelkouan,Puffinus_mauretanicus)),(Puffinus_lherminieri,Puffinus_assimilis)))),(Puffinus_huttoni,Puffinus_gavia))),(Calonectris_diomedea,Calonectris_leucomelas)),((Puffinus_tenuirostris,(Puffinus_pacificus,Puffinus_bulleri)),((Puffinus_griseus,Puffinus_gravis),(Puffinus_carneipes,Puffinus_creatopus))))),(Pseudobulweria_aterrima,Pseudobulweria_rostrata)),(((Bulweria_bulwerii,Procellaria_cinerea),(Procellaria_westlandica,(Procellaria_aequinoctialis,Procellaria_parkinsoni))),(Halobaena_caerulea,(Pachyptila_turtur,(Pachyptila_vittata,(Pachyptila_salvini,Pachyptila_desolata)))))),(Pagodroma_nivea,(Thalassoica_antarctica,(Daption_capense,((Fulmarus_glacialis,Fulmarus_glacialoides),(Macronectes_giganteus,Macronectes_halli)))))),((Pterodroma_axillaris,(Pterodroma_nigripennis,Pterodroma_cervicalis)),(Pterodroma_hypoleuca,(((Pterodroma_alba,(((Pterodroma_baraui,Pterodroma_arminjoniana),(Pterodroma_externa,Pterodroma_neglecta)),(Pterodroma_heraldica,(Pterodroma_phaeopygia,Pterodroma_sandwichensis)))),(Pterodroma_inexpectata,(Pterodroma_ultima,(Pterodroma_solandri,(Pterodroma_macroptera,(Pterodroma_magentae,((Pterodroma_mollis,(Pterodroma_feae,Pterodroma_madeira)),(Pterodroma_lessonii,(Pterodroma_incerta,(Pterodroma_cahow,Pterodroma_hasitata)))))))))),((Pterodroma_pycrofti,Pterodroma_longirostris),(Pterodroma_brevipes,(Pterodroma_leucoptera,(Pterodroma_cookii,Pterodroma_defilippiana)))))))),(Pelecanoides_garnotii,(Pelecanoides_urinatrix,(Pelecanoides_georgicus,Pelecanoides_magellani)))),((((Diomedea_dabbenena,((Diomedea_exulans,Diomedea_amsterdamensis),(Diomedea_gibsoni,Diomedea_antipodensis))),(Diomedea_epomophora,Diomedea_sanfordi)),(Phoebastria_irrorata,(Phoebastria_albatrus,(Phoebastria_immutabilis,Phoebastria_nigripes)))),((((Thalassarche_bulleri,(Thalassarche_cauta,(Thalassarche_eremita,Thalassarche_salvini))),(Thalassarche_chrysostoma,(Thalassarche_melanophris,Thalassarche_impavida))),(Thalassarche_chlororhynchus,Thalassarche_bassi)),(Phoebetria_fusca,Phoebetria_palpebrata)))),(Oceanites_oceanicus,((Pelagodroma_marina,Garrodia_nereis),(Fregetta_tropica,Fregetta_grallaria)))),(((Oceanodroma_tristrami,(Oceanodroma_leucorhoa,Oceanodroma_hornbyi)),(Oceanodroma_furcata,(Oceanodroma_castro,Hydrobates_pelagicus))),(Oceanodroma_melania,(Halocyptena_microsoma,Oceanodroma_tethys)))),(Gavia_immer,Gavia_stellata)),((Aptenodytes_patagonicus,(Eudyptes_chrysocome,Eudyptes_chrysolophus)),((Pygoscelis_papua,Pygoscelis_antarctica),(Pygoscelis_adeliae,((Megadyptes_antipodes,Eudyptes_pachyrhynchus),(Eudyptula_minor,Spheniscus_demersus))))));")
        $("#newickInputSecondLabel").val('');
        $("#opPrTrees").prop("checked", true);
        $("#opInclSum").prop("checked", true);
        $("#rbRefToAll").click();
    });
	/*<![CDATA[*/

    $(document).ready(function() {

        $('[data-toggle="tooltip"]').tooltip();
        Hide();

        var rbWindow = document.getElementById('rbWindow');
        var rbMatrix = document.getElementById('rbMatrix');
        var rbOverlapping = document.getElementById('rbOverlapping');
        var rbRefToAll = document.getElementById('rbRefToAll');

        if (!rbWindow.checked &&  !rbMatrix.checked && !rbOverlapping.checked && !rbRefToAll.checked) {
            rbMatrix.checked = true;
        }

        if ($(window).width() <= 768){
            $('.panel-collapse').removeClass('in');
        }
    });


    $(window).resize(function(){
        if ($(window).width() >= 768){
            OpenWholeAccordion();
        }
        if ($(window).width() <= 768){
            CloseWholeAccordion();
        }
    });

    $('a[data-toggle="collapse"]').click(function(e){
        if ($(window).width() >= 768){
            e.stopPropagation();
        }
    });

    function Hide() {
        firstTreeText.style.display = 'block';
        document.getElementById('rbWindowWidthInput').style.display = 'none';
        OpenWholeAccordion();
        if (document.getElementById('rbRefToAll').checked) {
            ShowSecondWindowAndHideNumberInput();
        }
        else if (document.getElementById('rbWindow').checked) {
            HideSecondWindowAndShowNumberInput();
        }
        else {
            HideSecondWindowAndHideNumberInput();
        }
    }
    function OpenWholeAccordion() {

        $("#collapse1").addClass("in");
        $("#collapse2").addClass("in");
        $("#collapse3").addClass("in");
        return;
    }
    function CloseWholeAccordion() {

        $("#collapse1").removeClass("in");
        $("#collapse2").removeClass("in");
        $("#collapse3").removeClass("in");
        return;
    }
    function ShowSecondWindowAndHideNumberInput() {

        var secondTreeText = document.getElementById('secondTreeText');
        secondTreeText.style.display = 'block';
        $("#firstTreeText").removeClass("col-md-12 col-lg-10");
        $("#firstTreeText").addClass("col-md-6 col-lg-5");
        HideNumberInput();
        return;
    }
    function HideSecondWindowAndHideNumberInput() {

        var secondTreeText = document.getElementById('secondTreeText');
        secondTreeText.style.display = 'none';
        $("#firstTreeText").removeClass("col-md-6 col-lg-5");
        $("#firstTreeText").addClass("col-md-12 col-lg-10");
        HideNumberInput();
        return;
    }

    function HideSecondWindowAndShowNumberInput() {

        HideSecondWindowAndHideNumberInput();
        ShowNumberInput();
        return;
    }


    function ShowNumberInput() {
        var numberInput = document.getElementById('rbWindowWidthInput');
        numberInput.style.display = 'inline-block';
        return;
    }


    function HideNumberInput() {
        var numberInput = document.getElementById('rbWindowWidthInput');
        numberInput.style.display = 'none';
        return;
    }


    inputTreeFile("newickInputFirst");
    inputTreeFile("newickInputSecond");

	/*
	 Called externally and allows to drag and drop text files for tree input
	 */
    function inputTreeFile(newickIn){
		/*
		 /
		 /    Enable drag and drop
		 /
		 */
        var MAX_BYTES = 102400; // 100 KB

        function dragEnter(event) {
            event.stopPropagation();
            event.preventDefault();
        }

        function dragExit(event) {
            event.stopPropagation();
            event.preventDefault();
        }

        function dragOver(event) {
            event.stopPropagation();
            event.preventDefault();
        }

        function drop(event) {
            event.stopPropagation();
            event.preventDefault();

            newickInputNumber = event.currentTarget.id == "newickInputFirst" ? 1 : 2;

            $("#renderErrorMessage" + newickInputNumber).empty();

            var data = event.dataTransfer;
            var file = data.files;

            var accept = {
                text   : ["txt", "nex", "nxs", "nh", "nhx", "nwk", "newick", "tre", "tree", "trees"]
            };

            var file_name_tokens = file[0].name.split(".");
            var file_name_ending = file_name_tokens[file_name_tokens.length-1];

            if (accept.text.indexOf(file_name_ending) > -1){
                var reader;
                reader = new FileReader();
                reader.onload = function(event) {
                    var error = checkTreeInput(event.target.result);
                    if(checkTreeInput(event.target.result)==""){
                        $("#" + newickIn).val(event.target.result);
                        $("#renderErrorMessage" + newickInputNumber).empty();
                    } else {
                        $("#renderErrorMessage" + newickInputNumber).empty();
                        $("#renderErrorMessage" + newickInputNumber).append($('<div> ' + error + ' </div>')).hide().slideDown(300);
                        $("#" + newickIn).attr("placeholder","Paste or drag and drop your trees in newick format separated by ;").val("");
                    }

                };
                reader.onloadend = onFileLoaded;
                reader.readAsText(file[0]);
                if(file[0].name == "")
                {
                    $("#" + newickIn+ "Label").attr("placeholder","Untitled").val("");
                }
                else
                {
                    $("#" + newickIn + "Label").val(file[0].name);
                }
            } else {
                $("#renderErrorMessage" + newickInputNumber).empty();
                $("#" + newickIn + "Label").text("No file");
                $("#renderErrorMessage" + newickInputNumber).append($('<div>Only the following file endings are accepted: txt, nex, nxs, nh, nhx, nwk, tre, tree</div>')).hide().slideDown(300);
                //$("#" + newickIn).val("");
                $("#" + newickIn+ "Label").attr("placeholder","Untitled").val("");
                $("#" + newickIn).attr("placeholder","Paste or drag and drop your trees in newick format separated by ;").val("");
            }

            // object for allowed media types

        }

        function onFileLoaded(event) {
            event.currentTarget.result.substr(0, MAX_BYTES);
        }

        var dropArea = $("#" + newickIn).get(0);

        dropArea.addEventListener("dragenter", dragEnter, false);
        dropArea.addEventListener("dragexit", dragExit, false);
        dropArea.addEventListener("dragover", dragOver, false);
        dropArea.addEventListener("drop", drop, false);

		/*
		 /
		 /    Enable file input using button
		 /
		 */
        var newickInButton = document.getElementById(newickIn+"Button");
        var control = document.getElementById(newickIn+"File");
        newickInButton.addEventListener('click',function(event){
            event.preventDefault();
            control.click();
            //$(this).find('span').toggleClass('glyphicon-file').toggleClass('glyphicon-remove');
        },false);


        control.addEventListener("change", function(event) {

            // When the control has changed, there are new files

            var file = control.files;


            var accept = {
                text   : ["txt", "nex", "nxs", "nh", "nhx", "nwk", "newick", "tre", "tree", "trees"]
            };

            var file_name_tokens = file[0].name.split(".");
            var file_name_ending = file_name_tokens[file_name_tokens.length-1];

            if (accept.text.indexOf(file_name_ending) > -1){
                var reader = new FileReader();
                reader.onload = function(event) {
                    var error = checkTreeInput(event.target.result);
                    if(checkTreeInput(event.target.result)==""){
                        $("#" + newickIn).val(event.target.result);
                        $("#renderErrorMessage" + newickInputNumber).empty();
                    } else {
                        $("#renderErrorMessage" + newickInputNumber).empty();
                        $("#renderErrorMessage" + newickInputNumber).append($('<div> ' + error + ' </div>')).hide().slideDown(300);
                        $("#" + newickIn).attr("placeholder","Paste or drag and drop your trees in newick format separated by ;").val("");
                    }

                };
                reader.onloadend = onFileLoaded;
                reader.readAsText(file[0]);
                if(file[0].name == "")
                {
                    $("#" + newickIn+ "Label").attr("placeholder","Untitled").val("");
                }
                else
                {
                    $("#" + newickIn + "Label").val(file[0].name);
                }

            } else {
                $("#renderErrorMessage" + newickInputNumber).empty();
                $("#renderErrorMessage" + newickInputNumber).append($('<div>Only the following file endings are accepted: txt, nex, nxs, nh, nhx, nwk, tre, tree</div>')).hide().slideDown(300);
                //$("#" + newickIn).val("");
                $("#" + newickIn+ "Label").attr("placeholder","Untitled").val("");
                $("#" + newickIn).attr("placeholder","Paste or drag and drop your trees in newick format separated by ;").val("");
            }


        }, false);

    }

	/*
	 Called externally to convert a tree and add to internal tree structure
	 */
    function addTree(newick, name) {

        //add required parameters to each node
        postorderTraverse(tree, function(d) {
            d.ID = makeId("node_");
            d.leaves = getChildLeaves(d);
            d.clickedParentHighlight = false;
            d.mouseoverHighlight = false; //when mouse is over node
            d.mouseoverLinkHighlight = false; //when mouse is over branch between two nodes
            d.correspondingHighlight = false;
            d.collapsed = false; //variable to obtain the node/nodes where collapsing starts
        });

        var root_ID = makeId("node_");
        for (var i = 0; i < tree.children.length; i++){
            tree.children[i].ID = root_ID;
        }

        var fullTree = {
            root: tree,
            name: name,
            data: {}
        };
        fullTree.data.autoCollapseDepth = getRecommendedAutoCollapse(tree);

        trees.push(fullTree);

        return fullTree;
    }

	/*
	 This function checks the consistency of the input string for the tree
	 */
    function checkTreeInput(s){
        var tokens = s.split(/\s*(;|\(|\[|\]|\)|,|:)\s*/);
        var outError = "";

        function isBracketsOrderCorrect(inArray){
            var nestingDepth = 0;
            var result = true;
            for(var i=0;i<inArray.length;i++) {
                if (inArray[i] === '(')
                    nestingDepth++;
                else if (inArray[i] === ')') {
                    nestingDepth--;
                    if (nestingDepth <= 0)
                        if (!(inArray[i+1] === ';' || inArray[i+2] === ';')) {
                            result = false;
                        }
                }
            }
            return result;
        }
        function returnNumElementInArray(inArray,element){
            var numOfTrue = 0;
            for(var i=0;i<inArray.length;i++){
                if(inArray[i] === element)
                    numOfTrue++;
            }
            return numOfTrue;
        }
        if (returnNumElementInArray(tokens,"(") > returnNumElementInArray(tokens,")")){
            outError = "Too little \")\" brackets";
        } else if (returnNumElementInArray(tokens,"(") < returnNumElementInArray(tokens,")")){
            outError = "Too little \"(\" brackets";
        } else if (!isBracketsOrderCorrect(tokens)) {
            outError = "Wrong brackets order";
        } /*else if (/!*tokens.indexOf(":") === -1 ||*!/ tokens.indexOf("(") === -1 || tokens.indexOf(")") === -1 || isNaN(tokens[tokens.indexOf(":")+1])){
            outError = "Not Newick trees";
        }*/

        return outError;
    }

	/*
	 traverses and performs function f on treenodes in postorder
	 if do_children === false, doesn't traverse _children, only children
	 _children means the children are not visible in the visualisation, i.e they are collapsed
	 */
    function postorderTraverse(d, f, do_children) {
        if (do_children === undefined) { //check whether variable is defined, e.g. string, integer ...
            do_children = true;
        }
        var children = [];
        if (do_children) {
            var children = getChildren(d);
        } else {
            if (d.children) {
                children = d.children;
            }
        }
        if (children.length > 0) {
            for (var i = 0; i < children.length; i++) {
                postorderTraverse(children[i], f, do_children);
            }
            f(d);
            return;

        } else {
            f(d);
            return;
        }
    }

	/*
	 Function that returns unvisible children or visible children if one or the other are given as input
	 */
    function getChildren(d) {
        return d._children ? d._children : (d.children ? d.children : []);
    }

	/*]]>*/

</script>

</html>
