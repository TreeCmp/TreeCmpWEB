!function t(e,n,r){function a(o,l){if(!n[o]){if(!e[o]){var c="function"==typeof require&&require;if(!l&&c)return c(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var s=n[o]={exports:{}};e[o][0].call(s.exports,function(t){var n=e[o][1][t];return a(n?n:t)},s,s.exports,t,e,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)a(r[o]);return a}({1:[function(t,e,n){e.exports=t("./index.js")},{"./index.js":2}],2:[function(t,e,n){"undefined"==typeof tnt&&(e.exports=tnt=t("./src/ta.js"));var r=t("biojs-events");r.mixin(tnt),tnt.utils=t("tnt.utils"),tnt.tree=t("tnt.tree"),tnt.tree.node=t("tnt.tree.node"),tnt.tree.parse_newick=t("tnt.newick").parse_newick,tnt.tree.parse_nhx=t("tnt.newick").parse_nhx,tnt.board=t("tnt.board")},{"./src/ta.js":32,"biojs-events":5,"tnt.board":8,"tnt.newick":16,"tnt.tree":20,"tnt.tree.node":18,"tnt.utils":27}],3:[function(t,e,n){!function(){function t(){return{keys:Object.keys||function(t){if("object"!=typeof t&&"function"!=typeof t||null===t)throw new TypeError("keys() called on a non-object");var e,n=[];for(e in t)t.hasOwnProperty(e)&&(n[n.length]=e);return n},uniqueId:function(t){var e=++c+"";return t?t+e:e},has:function(t,e){return o.call(t,e)},each:function(t,e,n){if(null!=t)if(i&&t.forEach===i)t.forEach(e,n);else if(t.length===+t.length)for(var r=0,a=t.length;r<a;r++)e.call(n,t[r],r,t);else for(var o in t)this.has(t,o)&&e.call(n,t[o],o,t)},once:function(t){var e,n=!1;return function(){return n?e:(n=!0,e=t.apply(this,arguments),t=null,e)}}}}var r,a=this,i=Array.prototype.forEach,o=Object.prototype.hasOwnProperty,l=Array.prototype.slice,c=0,s=t();r={on:function(t,e,n){if(!d(this,"on",t,[e,n])||!e)return this;this._events||(this._events={});var r=this._events[t]||(this._events[t]=[]);return r.push({callback:e,context:n,ctx:n||this}),this},once:function(t,e,n){if(!d(this,"once",t,[e,n])||!e)return this;var r=this,a=s.once(function(){r.off(t,a),e.apply(this,arguments)});return a._callback=e,this.on(t,a,n)},off:function(t,e,n){var r,a,i,o,l,c,u,f;if(!this._events||!d(this,"off",t,[e,n]))return this;if(!t&&!e&&!n)return this._events={},this;for(o=t?[t]:s.keys(this._events),l=0,c=o.length;l<c;l++)if(t=o[l],i=this._events[t]){if(this._events[t]=r=[],e||n)for(u=0,f=i.length;u<f;u++)a=i[u],(e&&e!==a.callback&&e!==a.callback._callback||n&&n!==a.context)&&r.push(a);r.length||delete this._events[t]}return this},trigger:function(t){if(!this._events)return this;var e=l.call(arguments,1);if(!d(this,"trigger",t,e))return this;var n=this._events[t],r=this._events.all;return n&&f(n,e),r&&f(r,arguments),this},stopListening:function(t,e,n){var r=this._listeners;if(!r)return this;var a=!e&&!n;"object"==typeof e&&(n=this),t&&((r={})[t._listenerId]=t);for(var i in r)r[i].off(e,n,this),a&&delete this._listeners[i];return this}};var u=/\s+/,d=function(t,e,n,r){if(!n)return!0;if("object"==typeof n){for(var a in n)t[e].apply(t,[a,n[a]].concat(r));return!1}if(u.test(n)){for(var i=n.split(u),o=0,l=i.length;o<l;o++)t[e].apply(t,[i[o]].concat(r));return!1}return!0},f=function(t,e){var n,r=-1,a=t.length,i=e[0],o=e[1],l=e[2];switch(e.length){case 0:for(;++r<a;)(n=t[r]).callback.call(n.ctx);return;case 1:for(;++r<a;)(n=t[r]).callback.call(n.ctx,i);return;case 2:for(;++r<a;)(n=t[r]).callback.call(n.ctx,i,o);return;case 3:for(;++r<a;)(n=t[r]).callback.call(n.ctx,i,o,l);return;default:for(;++r<a;)(n=t[r]).callback.apply(n.ctx,e)}},h={listenTo:"on",listenToOnce:"once"};s.each(h,function(t,e){r[e]=function(e,n,r){var a=this._listeners||(this._listeners={}),i=e._listenerId||(e._listenerId=s.uniqueId("l"));return a[i]=e,"object"==typeof n&&(r=this),e[t](n,r,this),this}}),r.bind=r.on,r.unbind=r.off,r.mixin=function(t){var e=["on","once","off","trigger","stopListening","listenTo","listenToOnce","bind","unbind"];return s.each(e,function(e){t[e]=this[e]},this),t},"undefined"!=typeof n?("undefined"!=typeof e&&e.exports&&(n=e.exports=r),n.BackboneEvents=r):"function"==typeof define&&"object"==typeof define.amd?define(function(){return r}):a.BackboneEvents=r}(this)},{}],4:[function(t,e,n){e.exports=t("./backbone-events-standalone")},{"./backbone-events-standalone":3}],5:[function(t,e,n){var r=t("backbone-events-standalone");r.onAll=function(t,e){return this.on("all",t,e),this},r.oldMixin=r.mixin,r.mixin=function(t){r.oldMixin(t);for(var e=["onAll"],n=0;n<e.length;n++){var a=e[n];t[a]=this[a]}return t},e.exports=r},{"backbone-events-standalone":4}],6:[function(t,e,n){e.exports=t("./src/api.js")},{"./src/api.js":7}],7:[function(t,e,n){var r=function(t){var e=function(){var t=[];return t.add_batch=function(e){t.unshift(e)},t.update=function(e,n){for(var r=0;r<t.length;r++)for(var a in t[r])if(a===e)return t[r][a]=n,!0;return!1},t.add=function(e,n){if(t.update(e,n));else{var r={};r[e]=n,t.add_batch(r)}},t.get=function(e){for(var n=0;n<t.length;n++)for(var r in t[n])if(r===e)return t[n][r]},t},n=e(),r=function(){};r.check=function(e,n,a){if(!(e instanceof Array))return"function"==typeof e?e.check(n,a):t[e].check(n,a),r;for(var i=0;i<e.length;i++)r.check(e[i],n,a)},r.transform=function(e,n){if(!(e instanceof Array))return"function"==typeof e?e.transform(n):t[e].transform(n),r;for(var a=0;a<e.length;a++)r.transform(e[a],n)};var a=function(e,r){var a=[],i=[],o=r.on_getter||function(){return n.get(e)},l=r.on_setter||function(t){for(var r=0;r<i.length;r++)t=i[r](t);for(var o=0;o<a.length;o++)if(!a[o].check(t)){var l=a[o].msg||"Value "+t+" doesn't seem to be valid for this method";throw l}n.add(e,t)},c=function(e){return arguments.length?(l(e),t):o()};c.check=function(t,e){return arguments.length?(a.push({check:t,msg:e}),this):a},c.transform=function(t){return arguments.length?(i.push(t),this):i},t[e]=c},i=function(t,e){if("object"==typeof t){n.add_batch(t);for(var r in t)a(r,e)}else n.add(t,e.default_value),a(t,e)};return r.getset=function(t,e){return i(t,{default_value:e}),r},r.get=function(t,e){var n=function(){throw"Method defined only as a getter (you are trying to use it as a setter"};return i(t,{default_value:e,on_setter:n}),r},r.set=function(t,e){var n=function(){throw"Method defined only as a setter (you are trying to use it as a getter"};return i(t,{default_value:e,on_getter:n}),r},r.method=function(e,n){if("object"==typeof e)for(var a in e)t[a]=e[a];else t[e]=n;return r},r};e.exports=n=r},{}],8:[function(t,e,n){e.exports=t("./src/index")},{"./src/index":12}],9:[function(t,e,n){var r=t("tnt.api"),a=t("tnt.utils").defer_cancel,i=function(){"use strict";function t(t){t.parentNode.appendChild(t)}var e,n,i,o,l,c=[],s=50,u=0,d=920,f=20,h={species:void 0,chr:void 0,from:0,to:500},v={left:void 0,right:void 0},p=3,g=d3.rgb("#F8FBEF"),_=d3.behavior.zoom(),m={min:0,max:1e3,zoom_out:1e3,zoom_in:100},y=500,b=!0,x={ease:d3.ease("cubic-in-out"),extend_canvas:{left:0,right:0},show_frame:!0},k=function(t){n=d3.select(t).attr("id"),d3.select(t).classed("tnt",!0);var r=d3.select(t).append("div").attr("id","tnt_"+n).style("position","relative").classed("tnt_framed",!!x.show_frame).style("width",d+2*p+x.extend_canvas.right+x.extend_canvas.left+"px"),a=r.append("div").attr("class","tnt_groupDiv");e=a.append("svg").attr("class","tnt_svg").attr("width",d).attr("height",u).attr("pointer-events","all"),o=e.append("g").attr("transform","translate(0,20)").append("g").attr("class","tnt_g"),v.left=o.append("rect").attr("id","tnt_"+n+"_5pcap").attr("x",0).attr("y",0).attr("width",0).attr("height",u).attr("fill","red"),v.right=o.append("rect").attr("id","tnt_"+n+"_3pcap").attr("x",d-p).attr("y",0).attr("width",0).attr("height",u).attr("fill","red"),i=o.append("rect").attr("class","tnt_pane").attr("id","tnt_"+n+"_pane").attr("width",d).attr("height",u).style("fill",g)},w=r(k).getset(x).getset(m).getset(h);w.transform(k.extend_canvas,function(t){var e=k.extend_canvas();return t.left=t.left||e.left,t.right=t.right||e.right,t}),w.method("start",function(){m.max-m.min<m.zoom_out&&(m.zoom_out=m.max-m.min),A();for(var t=0;t<c.length;t++)c[t].g&&c[t].g.remove(),C(c[t]);M();var e=function(){h.to-h.from<m.zoom_in&&(h.from+m.zoom_in>m.max?h.to=m.max:h.to=h.from+m.zoom_in);for(var t=0;t<c.length;t++)j(c[t],h)};e()}),w.method("update",function(){for(var t=0;t<c.length;t++)j(c[t])});var j=function(t,e){if(t.data()){var n=t.data(),r=n;r.call(t,{loc:e,on_success:function(){t.display().update.call(t,e)}})}},A=function(){l=d3.scale.linear().domain([h.from,h.to]).range([0,d]),b&&o.call(_.x(l).scaleExtent([(h.to-h.from)/(m.zoom_out-1),(h.to-h.from)/m.zoom_in]).on("zoom",N))},z=function(t){for(var e=[],n=0;n<t.length;n++){for(var r=!1,a=0;a<c.length;a++)if(c[a].id()===t[n].id()){r=!0,e[a]=!0;break}r||(C(t[n]),j(t[n],{from:h.from,to:h.to}))}for(var i=0;i<c.length;i++)e[i]||c[i].g.remove();c=t,M()};w.method("scroll",function(t){var e=Math.abs(t);t>0?E(e,1):t<0&&E(e,-1)}),w.method("zoom",function(t){E(1/t,0)}),w.method("find_track",function(t){for(var e=0;e<c.length;e++)if(c[e].id()===t)return c[e]}),w.method("remove_track",function(t){t.g.remove()}),w.method("add_track",function(t){if(t instanceof Array){for(var e=0;e<t.length;e++)k.add_track(t[e]);return k}return c.push(t),k}),w.method("tracks",function(t){return arguments.length?(z(t),this):c}),w.method("width",function(t){if(!arguments.length)return d;if(t<s&&(t=s),void 0!==n){d3.select("#tnt_"+n).select("svg").attr("width",t),d3.select("#tnt_"+n).style("width",parseInt(t)+2*p+"px"),d3.select("#tnt_"+n+"_pane").attr("width",t),v.right.attr("x",t-p),d=t,l.range([0,d]),A();for(var e=0;e<c.length;e++)c[e].g.select("rect").attr("width",t),c[e].display().scale(l),c[e].display().reset.call(c[e]),c[e].display().init.call(c[e],t),c[e].display().update.call(c[e],h)}else d=t;return k}),w.method("allow_drag",function(t){return arguments.length?(b=t,b?void 0!==l&&o.call(_.x(l).scaleExtent([(h.to-h.from)/(m.zoom_out-1),(h.to-h.from)/m.zoom_in]).on("zoom",N)):_.x(d3.scale.linear()).on("zoom",null),k):b});var M=function(){for(var r=0,a=0;a<c.length;a++){var o=c[a];o.g.attr("transform")?o.g.transition().duration(y).attr("transform","translate("+x.extend_canvas.left+","+r+")"):o.g.attr("transform","translate("+x.extend_canvas.left+","+r+")"),r+=o.height()}return e.attr("height",r+f),d3.select("#tnt_"+n).style("height",r+10+f+"px"),d3.select("#tnt_"+n+"_5pcap").attr("height",r).each(function(e){t(this)}),d3.select("#tnt_"+n+"_3pcap").attr("height",r).each(function(e){t(this)}),i.attr("height",r+f),k},C=function(t){return t.g=e.select("g").select("g").append("g").attr("class","tnt_track").attr("height",t.height()),t.g.append("rect").attr("x",0).attr("y",0).attr("width",k.width()).attr("height",t.height()).style("fill",t.color()).style("pointer-events","none"),t.display()&&t.display().scale(l).init.call(t,d),k},E=function(t,e){var n,r=l.domain(),a=r[1]-r[0],i=a*t-a;switch(e){case 1:n=[~~r[0]-i,~~(r[1]-i)];break;case-1:n=[~~r[0]+i,~~(r[1]-i)];break;case 0:n=[r[0]-~~(i/2),r[1]+~~i/2]}var o=d3.interpolateNumber(r[0],n[0]),c=x.ease,s=0;d3.timer(function(){var t,n=o(c(s));switch(e){case-1:t=n+a;break;case 1:t=n+a;break;case 0:t=r[1]+r[0]-n}var i=[n,t];return l.domain(i),N(l),s+=.02,s>1})},I=function(){var t=l.domain();k.from(~~t[0]),k.to(~~t[1]);for(var e=0;e<c.length;e++){var n=c[e];j(n,h)}},T=a(I,300),N=function(t){void 0!==t&&b&&_.x(t);var e=l.domain();e[0]<=m.min+5&&d3.select("#tnt_"+n+"_5pcap").attr("width",p).transition().duration(200).attr("width",0),e[1]>=m.max-5&&d3.select("#tnt_"+n+"_3pcap").attr("width",p).transition().duration(200).attr("width",0),e[0]<m.min?_.translate([_.translate()[0]-l(m.min)+l.range()[0],_.translate()[1]]):e[1]>m.max&&_.translate([_.translate()[0]-l(m.max)+l.range()[1],_.translate()[1]]),T();for(var r=0;r<c.length;r++){var a=c[r];a.display().mover.call(a)}};return k};e.exports=n=i},{"tnt.api":6,"tnt.utils":27}],10:[function(t,e,n){var r=t("tnt.api"),a=t("./spinner.js")();tnt_data={},tnt_data.sync=function(){var t=function(e){var n=this;n.data().elements(t.retriever().call(n,e.loc)),e.on_success()};return r(t).getset("elements",[]).getset("retriever",function(){}),t},tnt_data.async=function(){var t=function(e){var n=this;a.on.call(n),t.retriever().call(n,e.loc).then(function(t){n.data().elements(t),e.on_success(),a.off.call(n)})};r(t).getset("elements",[]).getset("retriever");return t},tnt_data.empty=function(){var t=tnt_data.sync();return t},e.exports=n=tnt_data},{"./spinner.js":14,"tnt.api":6}],11:[function(t,e,n){var r=t("tnt.api"),a=t("./layout.js"),i=function(){var t=d3.dispatch("click","dblclick","mouseover","mouseout"),e={create:function(){throw"create_elem is not defined in the base feature object"},move:function(){throw"move_elem is not defined in the base feature object"},distribute:function(){},fixed:function(){},index:void 0,layout:a.identity(),color:"#000",scale:void 0},n={},i=function(){var t=this;t.g.selectAll(".tnt_elem").remove(),t.g.selectAll(".tnt_guider").remove(),t.g.selectAll(".tnt_fixed").remove()},o=function(t){var n=this;n.g.append("text").attr("class","tnt_fixed").attr("x",5).attr("y",12).attr("font-size",11).attr("fill","grey").text(n.label()),e.fixed.call(n,t)},l=function(n,r,a){n.on("click",function(e,n){d3.event.defaultPrevented||t.click.call(this,e,n)}),n.on("mouseover",function(e,n){d3.event.defaultPrevented||t.mouseover.call(this,e,n)}),n.on("dblclick",function(e,n){d3.event.defaultPrevented||t.dblclick.call(this,e,n)}),n.on("mouseout",function(e,n){d3.event.defaultPrevented||t.mouseout.call(this,e,n)}),e.create.call(r,n,a)},c=function(t,r){var a=this,i=a.g,o=a.data().elements();void 0!==r&&(o=o[r]);var l=e.layout.call(a,o);if(void 0!==l){var c,s;c=void 0!==r?i.selectAll(".tnt_elem_"+r):i.selectAll(".tnt_elem"),s=e.index?c.data(l,function(t){if(void 0!==t)return e.index(t)}):c.data(l),e.distribute.call(a,s,e.scale);var u=s.enter();u.append("g").attr("class","tnt_elem").classed("tnt_elem_"+r,r).call(n.plot,a,e.scale),s.exit().remove()}},s=function(t){var n,r=this,a=r.g;n=void 0!==t?a.selectAll(".tnt_elem_"+t):a.selectAll(".tnt_elem"),e.move.call(this,n)},u=function(t){t.parentNode.appendChild(t)},d=function(t){if(void 0!==t){var e=this,n=e.g;n.selectAll(".tnt_elem_"+t).each(function(){u(this)})}};return r(n).getset(e).method({reset:i,plot:l,update:c,mover:s,init:o,move_to_front:d}),d3.rebind(n,t,"on")};i.composite=function(){var t={},e=[],n={},a=function(){var e=this;for(var n in t)t.hasOwnProperty(n)&&t[n].reset.call(e)},i=function(e){var r=this;for(var a in t)t.hasOwnProperty(a)&&(t[a].scale(n.scale()),t[a].init.call(r,e))},o=function(){for(var n=this,r=0;r<e.length;r++)t[e[r]].update.call(n,void 0,e[r]),t[e[r]].move_to_front.call(n,e[r])},l=function(){var e=this;for(var n in t)t.hasOwnProperty(n)&&t[n].mover.call(e,n)},c=function(r,a){return t[r]=a,e.push(r),n},s=function(){for(var n=[],r=0;r<e.length;r++)n.push(t[e[r]]);return n};return r(n).getset("scale").method({reset:a,update:o,mover:l,init:i,add:c,displays:s}),n},i.area=function(){var t,e=i.line(),n=e.line(),r=d3.svg.area().interpolate(n.interpolate()).tension(e.tension()),a=e.create();e.create(function(i){var o=this,l=e.scale();void 0!==t&&o.g.select("path").remove(),a.call(o,i,l),r.x(n.x()).y1(n.y()).y0(o.height()),t=i.data(),i.remove(),o.g.append("path").attr("class","tnt_area").classed("tnt_elem",!0).datum(t).attr("d",r).attr("fill",d3.rgb(e.color()).brighter())});var o=e.move();return e.move(function(a){var i=this,l=e.scale();o.call(i,a,l),r.x(n.x()),i.g.select(".tnt_area").datum(t).attr("d",r)}),e},i.line=function(){var t=i(),e=function(t){return t.pos},n=function(t){return t.val},r=.7,a=d3.scale.linear(),o=d3.svg.line().interpolate("basis");t.line=function(){return o},t.x=function(n){return arguments.length?(e=n,t):e},t.y=function(e){return arguments.length?(n=e,t):n},t.tension=function(e){return arguments.length?(r=e,t):r};var l;return t.create(function(i){var c=this,s=t.scale();void 0!==l&&c.g.select("path").remove(),o.tension(r).x(function(t){return s(e(t))}).y(function(t){return c.height()-a(n(t))}),l=i.data(),i.remove(),a.domain([0,1]).range([0,c.height()-2]),c.g.append("path").attr("class","tnt_elem").attr("d",o(l)).style("stroke",t.color()).style("stroke-width",4).style("fill","none")}),t.move(function(n){var r=this,a=t.scale();o.x(function(t){return a(e(t))}),r.g.select("path").attr("d",o(l))}),t},i.conservation=function(){var t=i.area(),e=t.create();return t.create(function(n){var r=this,a=t.scale();e.call(r,d3.select(n[0][0]),a)}),t},i.ensembl=function(){var t=i(),e="#7FFF00",n="#00BB00";return t.fixed(function(e){var n=this,r=~~(n.height()-.8*n.height())/2;n.g.append("line").attr("class","tnt_guider tnt_fixed").attr("x1",0).attr("x2",e).attr("y1",r).attr("y2",r).style("stroke",t.color()).style("stroke-width",1),n.g.append("line").attr("class","tnt_guider tnt_fixed").attr("x1",0).attr("x2",e).attr("y1",n.height()-r).attr("y2",n.height()-r).style("stroke",t.color()).style("stroke-width",1)}),t.create(function(e){var n=this,r=t.scale(),a=~~(n.height()-.8*n.height())/2;e.append("rect").attr("x",function(t){return r(t.start)}).attr("y",a).attr("width",function(t){return r(t.end)-r(t.start)}).attr("height",n.height()-~~(2*a)).attr("fill",n.color()).transition().duration(500).attr("fill",function(e){return"high"===e.type?d3.rgb(t.color()):"low"===e.type?d3.rgb(t.color2()):d3.rgb(t.color3())})}),t.distribute(function(e){var n=t.scale();e.select("rect").attr("width",function(t){return n(t.end)-n(t.start)})}),t.move(function(e){var n=t.scale();e.select("rect").attr("x",function(t){return n(t.start)}).attr("width",function(t){return n(t.end)-n(t.start)})}),t.color2=function(n){return arguments.length?(e=n,t):e},t.color3=function(e){return arguments.length?(n=e,t):n},t},i.vline=function(){var t=i();return t.create(function(e){var n=t.scale(),r=this;e.append("line").attr("x1",function(e){return n(t.index()(e))}).attr("x2",function(e){return n(t.index()(e))}).attr("y1",0).attr("y2",r.height()).attr("stroke",t.color()).attr("stroke-width",1)}),t.move(function(e){var n=t.scale();e.select("line").attr("x1",function(e){return n(t.index()(e))}).attr("x2",function(e){return n(t.index()(e))})}),t},i.pin=function(){var t=i(),e=d3.scale.linear().domain([0,0]).range([0,0]),n={pos:d3.functor("pos"),val:d3.functor("val"),domain:[0,0]},a=5;return r(t).getset(n),t.create(function(r){var i=this,o=t.scale();e.domain(t.domain()).range([a,i.height()-a-10]),r.append("line").attr("x1",function(t,e){return o(t[n.pos(t,e)])}).attr("y1",function(t){return i.height()}).attr("x2",function(t,e){return o(t[n.pos(t,e)])}).attr("y2",function(t,r){return i.height()-e(t[n.val(t,r)])}).attr("stroke",function(e){return d3.functor(t.color())(e)}),r.append("circle").attr("cx",function(t,e){return o(t[n.pos(t,e)])}).attr("cy",function(t,r){return i.height()-e(t[n.val(t,r)])}).attr("r",a).attr("fill",function(e){return d3.functor(t.color())(e)}),r.append("text").attr("font-size","13").attr("x",function(t,e){return o(t[n.pos(t,e)])}).attr("y",function(t,e){return 10}).style("text-anchor","middle").text(function(t){return t.label||""})}),t.distribute(function(t){t.select("text").text(function(t){return t.label||""})}),t.move(function(r){var a=this,i=t.scale();r.select("line").attr("x1",function(t,e){return i(t[n.pos(t,e)])}).attr("y1",function(t){return a.height()}).attr("x2",function(t,e){return i(t[n.pos(t,e)])}).attr("y2",function(t,r){return a.height()-e(t[n.val(t,r)])}),r.select("circle").attr("cx",function(t,e){return i(t[n.pos(t,e)])}).attr("cy",function(t,r){return a.height()-e(t[n.val(t,r)])}),r.select("text").attr("x",function(t,e){return i(t[n.pos(t,e)])}).text(function(t){return t.label||""})}),t.fixed(function(t){var e=this;e.g.append("line").attr("class","tnt_fixed").attr("x1",0).attr("x2",t).attr("y1",e.height()).attr("y2",e.height()).style("stroke","black").style("stroke-with","1px")}),t},i.block=function(){var t=i();return r(t).getset("from",function(t){return t.start}).getset("to",function(t){return t.end}),t.create(function(e){var n=this,r=t.scale();e.append("rect").attr("x",function(e,n){return r(t.from()(e,n))}).attr("y",0).attr("width",function(e,n){return r(t.to()(e,n))-r(t.from()(e,n))}).attr("height",n.height()).attr("fill",n.color()).transition().duration(500).attr("fill",function(e){return void 0===e.color?t.color():e.color})}),t.distribute(function(e){var n=t.scale();e.select("rect").attr("width",function(t){return n(t.end)-n(t.start)})}),t.move(function(e){var n=t.scale();e.select("rect").attr("x",function(t){return n(t.start)}).attr("width",function(t){return n(t.end)-n(t.start)})}),t},i.axis=function(){var t,e,n="top",r={};return r.reset=function(){t=void 0;var e=this;e.g.selectAll(".tick").remove()},r.plot=function(){},r.mover=function(){var e=this,n=e.g;n.call(t)},r.init=function(){t=void 0},r.update=function(){void 0===t&&(t=d3.svg.axis().scale(e).orient(n));var r=this,a=r.g;a.call(t)},r.orientation=function(t){return arguments.length?(n=t,this):n},r.scale=function(t){return arguments.length?(e=t,this):e},r},i.location=function(){var t,e,n={};return n.reset=function(){t=void 0},n.plot=function(){},n.init=function(){t=void 0;var e=this;e.g.select("text").remove()},n.mover=function(){var n=e.domain();t.select("text").text("Location: "+~~n[0]+"-"+~~n[1])},n.scale=function(t){return arguments.length?(e=t,this):e},n.update=function(n){var r=this,a=r.g,i=e.domain();void 0===t&&(t=a,t.append("text").text("Location: "+Math.round(i[0])+"-"+Math.round(i[1])))},n},e.exports=n=i},{"./layout.js":13,"tnt.api":6}],12:[function(t,e,n){var r=t("./board.js");r.track=t("./track"),r.track.data=t("./data.js"),r.track.layout=t("./layout.js"),r.track.feature=t("./feature.js"),r.track.layout=t("./layout.js"),e.exports=n=r},{"./board.js":9,"./data.js":10,"./feature.js":11,"./layout.js":13,"./track":15}],13:[function(t,e,n){var r=t("tnt.api"),a=function(){var t=function(e){var n=this;return t.elements().call(n,e),e};r(t).getset("elements",function(){});return t};a.identity=function(){return a().elements(function(t){return t})},e.exports=n=a},{"tnt.api":6}],14:[function(t,e,n){var r=function(){function t(t,e,n){t.append("rect").attr("x","46.5").attr("y","40").attr("width","7").attr("height","20").attr("rx","5").attr("ry","5").attr("fill",d3.rgb(n).darker(2)).attr("transform","rotate("+30*e+" 50 50) translate(0 -30)").append("animate").attr("attributeName","opacity").attr("from","1").attr("to","0").attr("dur","1s").attr("begin",1/12*e+"s").attr("repeatCount","indefinite")}var e,n={};return n.on=function(){var n=this;if(n.spinner?n.spinner++:n.spinner=1,1==n.spinner){var r=n.g,a=n.color();e=r.append("svg").attr("class","tnt_spinner").attr("width","30px").attr("height","30px").attr("xmls","http://www.w3.org/2000/svg").attr("viewBox","0 0 100 100").attr("preserveAspectRatio","xMidYMid"),e.append("rect").attr("x","0").attr("y","0").attr("width","100").attr("height","100").attr("rx","50").attr("ry","50").attr("fill",a);for(var i=0;i<12;i++)t(e,i,a)}else if(n.spinner>0){var o=e.node();o.parentNode&&o.parentNode.appendChild(o)}},n.off=function(){var t=this;if(t.spinner--,!t.spinner){var e=t.g;e.selectAll(".tnt_spinner").remove()}},n};e.exports=n=r},{}],15:[function(t,e,n){var r=t("tnt.api"),a=t("tnt.utils").iterator,i=function(){"use strict";var t,e={color:d3.rgb("#CCCCCC"),height:250,data:i.data.empty(),label:"",id:i.id()},n={};r(n).getset(e);return n.display=function(n){if(!arguments.length)return t;if(t=n,"function"==typeof t)t.layout&&t.layout().height(e.height);else for(var r in t)t.hasOwnProperty(r)&&t[r].layout&&t[r].layout().height(e.height);return this},n};i.id=a(1),e.exports=n=i},{"tnt.api":6,"tnt.utils":27}],16:[function(t,e,n){e.exports=t("./src/newick.js")},{"./src/newick.js":17}],17:[function(t,e,n){e.exports={parse_newick:function(t){for(var e,n=[],r={},a=t.split(/\s*(;|\(|\)|,|:)\s*/),i=0;i<a.length;i++){var o=a[i];switch(o){case"(":e={},r.children=[e],n.push(r),r=e;break;case",":e={},n[n.length-1].children.push(e),r=e;break;case")":r=n.pop();break;case":":break;default:var l=a[i-1];")"==l||"("==l||","==l?r.name=o:":"==l&&(r.branch_length=parseFloat(o))}}return r},parse_nhx:function(t){for(var e,n=[],r={},a=t.split(/\s*(;|\(|\)|\[|\]|,|:|=)\s*/),i=0;i<a.length;i++){var o=a[i];switch(o){case"(":e={},r.children=[e],n.push(r),r=e;break;case",":e={},n[n.length-1].children.push(e),r=e;break;case")":r=n.pop();break;case":":break;default:var l=a[i-1];if(")"==l||"("==l||","==l)r.name=o;else if(":"==l){isNaN(o)||(r.branch_length=parseFloat(o))}else if("="==l){var c=a[i-2];switch(c){case"D":r.duplication=o;break;case"G":r.gene_id=o;break;case"T":r.taxon_id=o;break;default:r[a[i-2]]=o}}else;}}return r}}},{}],18:[function(t,e,n){var r=t("./src/node.js");e.exports=n=r},{"./src/node.js":19}],19:[function(t,e,n){var r=t("tnt.api"),a=t("tnt.utils").iterator,i=function(t){"use strict";var e=function(){},n=r(e),o=function(t,e){if(e(t),void 0!==t.children)for(var n=0;n<t.children.length;n++)o(t.children[n],e)},l=function(){var e=a(1);o(t,function(t){void 0===t._id&&(t._id=e())})},c=function(t){if(void 0!==t&&void 0!==t.children)for(var e=0;e<t.children.length;e++)t.children[e]._parent=t,c(t.children[e])},s=function(t){o(t,function(t){var e;if(void 0===t._parent)t._root_dist=0;else{var e=0;t.branch_length&&(e=t.branch_length),t._root_dist=e+t._parent._root_dist}})};e.data=function(n){return arguments.length?(t=n,l(),c(t),s(t),e):t},e.data(t),n.method("find_all",function(t,n){var r=[];return e.apply(function(e){t(e)&&r.push(e)}),r}),n.method("find_node",function(n,r){if(n(e))return e;if(void 0!==t.children)for(var a=0;a<t.children.length;a++){var o=i(t.children[a]).find_node(n,r);if(o)return o}if(r&&void 0!==t._children)for(var l=0;l<t._children.length;l++){i(t._children[l]).find_node(n,r);var o=i(t._children[l]).find_node(n,r);if(o)return o}}),n.method("find_node_by_name",function(t,n){return e.find_node(function(e){return e.node_name()===t},n)}),n.method("toggle",function(){if(t)if(t.children){var n=0;e.apply(function(t){t.n_hidden()||0;n+=(t.n_hidden()||0)+1}),e.n_hidden(n-1),t._children=t.children,t.children=void 0}else e.n_hidden(0),t.children=t._children,t._children=void 0;return this}),n.method("is_collapsed",function(){return void 0!==t._children&&void 0===t.children});var u=function(t,e){if(t=t.data(),e=e.data(),void 0===t._parent)return!1;for(t=t._parent;;){if(void 0===t)return!1;if(t===e)return!0;t=t._parent}};n.method("lca",function(t){if(1===t.length)return t[0];for(var e=t[0],n=1;n<t.length;n++)e=d(e,t[n]);return e});var d=function(t,e){return t.data()===e.data()?t:u(t,e)?e:d(t,e.parent())};n.method("n_hidden",function(t){return arguments.length?(e.property("_hidden",t),e):e.property("_hidden")}),n.method("get_all_nodes",function(t){var n=[];return e.apply(function(t){n.push(t)},t),n}),n.method("get_all_leaves",function(t){var n=[];return e.apply(function(e){e.is_leaf(t)&&n.push(e)},t),n}),n.method("upstream",function(t){t(e);var n=e.parent();void 0!==n&&n.upstream(t)}),n.method("subtree",function(e,n){void 0===n&&(n=!1);for(var r={},a=0;a<e.length;a++){var o=e[a];void 0!==o&&o.upstream(function(t){var e=t.id();void 0===r[e]&&(r[e]=0),r[e]++})}var l=function(t){var e=0;if(void 0===t.children)return!1;for(var n=0;n<t.children.length;n++){var a=t.children[n]._id;r[a]>0&&e++}return 1===e},c={};return f(t,c,0,function(t){var e=t._id,a=r[e];return a>0&&!(l(t)&&!n)}),i(c.children[0])});var f=function(t,e,n,r){if(void 0!==t)if(r(t)){var a=h(t,n);if(void 0===e.children&&(e.children=[]),e.children.push(a),void 0===t.children)return;for(var i=0;i<t.children.length;i++)f(t.children[i],a,0,r)}else{if(void 0===t.children)return;n+=t.branch_length||0;for(var i=0;i<t.children.length;i++)f(t.children[i],e,n,r)}},h=function(t,e){var n={};for(var r in t)"children"!==r&&"_children"!==r&&"_parent"!==r&&"depth"!==r&&t.hasOwnProperty(r)&&(n[r]=t[r]);return void 0!==n.branch_length&&void 0!==e&&(n.branch_length+=e),n};return n.method("present",function(t){var n=!1;return e.apply(function(e){t(e)===!0&&(n=!0)}),n}),n.method("sort",function(e){if(void 0!==t.children){for(var n=[],r=0;r<t.children.length;r++)n.push(i(t.children[r]));n.sort(e),t.children=[];for(var r=0;r<n.length;r++)t.children.push(n[r].data());for(var r=0;r<t.children.length;r++)i(t.children[r]).sort(e)}}),n.method("flatten",function(t){if(e.is_leaf())return e;var n,r=e.data(),a=h(r);t?(n=e.get_all_nodes(),n.shift()):n=e.get_all_leaves(),a.children=[];for(var o=0;o<n.length;o++)delete n[o].children,a.children.push(h(n[o].data()));return i(a)}),n.method("apply",function(n,r){if(void 0===r&&(r=!1),n(e),void 0!==t.children)for(var a=0;a<t.children.length;a++){var o=i(t.children[a]);o.apply(n,r)}if(void 0!==t._children&&r)for(var l=0;l<t._children.length;l++){var o=i(t._children[l]);o.apply(n,r)}}),n.method("property",function(n,r){return 1===arguments.length?"function"==typeof n?n(t):t[n]:("function"==typeof n&&n(t,r),t[n]=r,e)}),n.method("is_leaf",function(e){return e?void 0===t.children&&void 0===t._children:void 0===t.children}),n.method("id",function(){return e.property("_id")}),n.method("node_name",function(){return e.property("name")}),n.method("branch_length",function(){return e.property("branch_length")}),n.method("root_dist",function(){return e.property("_root_dist")}),n.method("children",function(e){var n=[];if(t.children)for(var r=0;r<t.children.length;r++)n.push(i(t.children[r]));if(t._children&&e)for(var a=0;a<t._children.length;a++)n.push(i(t._children[a]));if(0!==n.length)return n}),n.method("parent",function(){if(void 0!==t._parent)return i(t._parent)}),e};e.exports=n=i},{"tnt.api":6,"tnt.utils":27}],20:[function(t,e,n){e.exports=tree=t("./src/index.js");var r=t("biojs-events");r.mixin(tree)},{"./src/index.js":22,"biojs-events":5}],21:[function(t,e,n){var r=t("tnt.api"),a={};a.diagonal=function(){var t=function(e){var r=e.source,a=e.target,i=((r.x+a.x)/2,(r.y+a.y)/2,[r,{x:a.x,y:r.y},a]);return i=i.map(t.projection()),t.path()(i,n.call(this,i))},e=(r(t).getset("projection").getset("path"),function(t,e){var n,r=2*Math.PI,a=r/4,i=t[0]>=0?t[1]>=0?1:2:t[1]>=0?4:3,o=Math.abs(Math.asin(t[1]/e));switch(i){case 1:n=a-o;break;case 2:n=a+o;break;case 3:n=2*a+a-o;break;case 4:n=3*a+o}return n}),n=function(t){var n=t[0],r=t[1],a=(t[2],Math.sqrt(n[0]*n[0]+n[1]*n[1])),i=e(n,a),o=e(r,a),l=Math.abs(o-i)>Math.PI?o<=i:o>i;return{radius:a,clockwise:l}};return t},a.diagonal.vertical=function(t){var e=function(t,e){var n=t[0],r=t[1],a=t[2],i=2e3*(r[1]-n[1]);return"M"+n+" A"+[i,i]+" 0 0,0 "+r+"M"+r+"L"+a},n=function(t){return[t.y,t.x]};return a.diagonal().path(e).projection(n)},a.diagonal.radial=function(){var t=function(t,e){var n=t[0],r=t[1],a=t[2],i=e.radius,o=e.clockwise;return o?"M"+n+" A"+[i,i]+" 0 0,0 "+r+"M"+r+"L"+a:"M"+r+" A"+[i,i]+" 0 0,0 "+n+"M"+r+"L"+a},e=function(t){var e=t.y,n=(t.x-90)/180*Math.PI;return[e*Math.cos(n),e*Math.sin(n)]};return a.diagonal().path(t).projection(e)},e.exports=n=a.diagonal},{"tnt.api":6}],22:[function(t,e,n){var r=t("./tree.js");r.label=t("./label.js"),r.diagonal=t("./diagonal.js"),r.layout=t("./layout.js"),r.node_display=t("./node_display.js"),e.exports=n=r},{"./diagonal.js":21,"./label.js":23,"./layout.js":24,"./node_display.js":25,"./tree.js":26}],23:[function(t,e,n){var r=t("tnt.api"),a={};a.label=function(){"use strict";var t=d3.dispatch("click","dblclick","mouseover","mouseout"),e=function(n,r,a){if("function"!=typeof n)throw n;e.display().call(this,n,r).attr("class","tnt_tree_label").attr("transform",function(t){var i=e.transform()(n,r);return"translate ("+(i.translate[0]+a)+" "+i.translate[1]+")rotate("+i.rotate+")"}).on("click",function(){t.click.call(this,n)}).on("dblclick",function(){t.dblclick.call(this,n)}).on("mouseover",function(){t.mouseover.call(this,n)}).on("mouseout",function(){t.mouseout.call(this,n)})};r(e).getset("width",function(){throw"Need a width callback"}).getset("height",function(){throw"Need a height callback"}).getset("display",function(){throw"Need a display callback"}).getset("transform",function(){throw"Need a transform callback"});return d3.rebind(e,t,"on")},a.label.text=function(){
var t=a.label();r(t).getset("fontsize",10).getset("fontweight","normal").getset("color","#000").getset("text",function(t){return t.data().name});return t.display(function(e,n){var r=d3.select(this).append("text").attr("text-anchor",function(t){return"radial"===n?t.x%360<180?"start":"end":"start"}).text(function(){return t.text()(e)}).style("font-size",function(){return d3.functor(t.fontsize())(e)+"px"}).style("font-weight",function(){return d3.functor(t.fontweight())(e)}).style("fill",d3.functor(t.color())(e));return r}),t.transform(function(e,n){var r=e.data(),a={translate:[5,5],rotate:0};return"radial"===n&&(a.translate[1]=a.translate[1]-(r.x%360<180?0:t.fontsize()),a.rotate=r.x%360<180?0:180),a}),t.width(function(e){var n=d3.select("body").append("svg").attr("height",0).style("visibility","hidden"),r=n.append("text").style("font-size",d3.functor(t.fontsize())(e)+"px").text(t.text()(e)),a=r.node().getBBox().width;return n.remove(),a}),t.height(function(e){return d3.functor(t.fontsize())(e)}),t},a.label.svg=function(){var t=a.label();r(t).getset("element",function(t){return t.data().element});return t.display(function(e,n){var r=t.element()(e);return this.appendChild(r.node()),r}),t.transform(function(e,n){var r=e.data(),a={translate:[10,-t.height()()/2],rotate:0};return"radial"===n&&(a.translate[0]=a.translate[0]+(r.x%360<180?0:t.width()()),a.translate[1]=a.translate[1]+(r.x%360<180?0:t.height()()),a.rotate=r.x%360<180?0:180),a}),t},a.label.img=function(){var t=a.label();r(t).getset("src",function(){});return t.display(function(e,n){if(t.src()(e)){var r=d3.select(this).append("image").attr("width",t.width()()).attr("height",t.height()()).attr("xlink:href",t.src()(e));return r}return d3.select(this).append("text").text("")}),t.transform(function(e,n){var r=e.data(),a={translate:[10,-t.height()()/2],rotate:0};return"radial"===n&&(a.translate[0]=a.translate[0]+(r.x%360<180?0:t.width()()),a.translate[1]=a.translate[1]+(r.x%360<180?0:t.height()()),a.rotate=r.x%360<180?0:180),a}),t},a.label.composite=function(){var t=[],e=function(e,n,r){for(var a=0,i=0;i<t.length;i++){var o=t[i];!function(t){o.transform(function(e,n){var r=o._super_.transform()(e,n),a={translate:[t+r.translate[0],r.translate[1]],rotate:r.rotate};return a})}(a),a+=10,a+=o.width()(e),o.call(this,e,n,r)}},n=r(e);return n.method("add_label",function(n,a){return n._super_={},r(n._super_).get("transform",n.transform()),t.push(n),e}),n.method("width",function(){return function(e){for(var n=0,r=0;r<t.length;r++)n+=parseInt(t[r].width()(e)),n+=parseInt(t[r]._super_.transform()(e).translate[0]);return n}}),n.method("height",function(){return function(e){for(var n=0,r=0;r<t.length;r++){var a=t[r].height()(e);a>n&&(n=a)}return n}}),e},e.exports=n=a.label},{"tnt.api":6}],24:[function(t,e,n){var r=t("tnt.api"),a=t("./diagonal.js"),i={};i.layout=function(){var t=function(){},e=d3.layout.cluster().sort(null).value(function(t){return t.length}).separation(function(){return 1}),n=r(t).getset("scale",!0).getset("max_leaf_label_width",0).method("cluster",e).method("yscale",function(){throw"yscale is not defined in the base object"}).method("adjust_cluster_size",function(){throw"adjust_cluster_size is not defined in the base object"}).method("width",function(){throw"width is not defined in the base object"}).method("height",function(){throw"height is not defined in the base object"});return n.method("scale_branch_lengths",function(e){if(t.scale()!==!1){var n=e.nodes,r=e.tree,a=n.map(function(t){return t._root_dist}),i=t.yscale(a);r.apply(function(t){t.property("y",i(t.root_dist()))})}}),t},i.layout.vertical=function(){var t=i.layout();t.type="vertical";var e=r(t).getset("width",360).get("translate_vis",[20,20]).method("diagonal",a.vertical).method("transform_node",function(t){return"translate("+t.y+","+t.x+")"});return e.method("height",function(t){return t.n_leaves*t.label_height}),e.method("yscale",function(e){return d3.scale.linear().domain([0,d3.max(e)]).range([0,t.width()-20-t.max_leaf_label_width()])}),e.method("adjust_cluster_size",function(e){var n=t.height(e),r=t.width()-t.max_leaf_label_width()-t.translate_vis()[0]-e.label_padding;return t.cluster.size([n,r]),t}),t},i.layout.radial=function(){var t=i.layout();t.type="radial";var e=360,n=e/2,o={width:360},l=r(t).getset(o).getset("translate_vis",[n,n]).method("transform_node",function(t){return"rotate("+(t.x-90)+")translate("+t.y+")"}).method("diagonal",a.radial).method("height",function(){return o.width});return t.width.transform(function(e){return n=e/2,t.cluster.size([360,n]),t.translate_vis([n,n]),e}),l.method("yscale",function(t){return d3.scale.linear().domain([0,d3.max(t)]).range([0,n])}),l.method("adjust_cluster_size",function(e){return n=t.width()/2-t.max_leaf_label_width()-20,t.cluster.size([360,n]),t}),t},e.exports=n=i.layout},{"./diagonal.js":21,"tnt.api":6}],25:[function(t,e,n){var r=t("tnt.api"),a={};a.node_display=function(){"use strict";var t=function(e){var n,r=d3.select(this).select(".tnt_tree_node_proxy");n=null===r[0][0]?d3.select(this).append("rect").attr("class","tnt_tree_node_proxy"):r,t.display().call(this,e);var a=d3.functor(t.size())(e);n.attr("x",-a).attr("y",-a).attr("width",2*a).attr("height",2*a)},e=r(t).getset("size",4.4).getset("fill","black").getset("stroke","black").getset("stroke_width","1px").getset("display",function(){throw"display is not defined in the base object"});return e.method("reset",function(){d3.select(this).selectAll("*:not(.tnt_tree_node_proxy)").remove()}),t},a.node_display.circle=function(){var t=a.node_display();return t.display(function(e){d3.select(this).append("circle").attr("r",function(n){return d3.functor(t.size())(e)}).attr("fill",function(n){return d3.functor(t.fill())(e)}).attr("stroke",function(n){return d3.functor(t.stroke())(e)}).attr("stroke-width",function(n){return d3.functor(t.stroke_width())(e)}).attr("class","tnt_node_display_elem")}),t},a.node_display.square=function(){var t=a.node_display();return t.display(function(e){var n=d3.functor(t.size())(e);d3.select(this).append("rect").attr("x",function(t){return-n}).attr("y",function(t){return-n}).attr("width",function(t){return 2*n}).attr("height",function(t){return 2*n}).attr("fill",function(n){return d3.functor(t.fill())(e)}).attr("stroke",function(n){return d3.functor(t.stroke())(e)}).attr("stroke-width",function(n){return d3.functor(t.stroke_width())(e)}).attr("class","tnt_node_display_elem")}),t},a.node_display.triangle=function(){var t=a.node_display();return t.display(function(e){var n=d3.functor(t.size())(e);d3.select(this).append("polygon").attr("points",-n+",0 "+n+","+-n+" "+n+","+n).attr("fill",function(n){return d3.functor(t.fill())(e)}).attr("stroke",function(n){return d3.functor(t.stroke())(e)}).attr("stroke-width",function(n){return d3.functor(t.stroke_width())(e)}).attr("class","tnt_node_display_elem")}),t},e.exports=n=a.node_display},{"tnt.api":6}],26:[function(t,e,n){var r=t("tnt.api"),a=t("tnt.tree.node"),i=function(){"use strict";var t,e,n,o,l,c=d3.dispatch("click","dblclick","mouseover","mouseout","load"),s={duration:500,node_display:i.node_display.circle(),label:i.label.text(),layout:i.layout.vertical(),branch_color:"black",id:function(t){return t._id}},u="cubic-in-out",d={tree:void 0,data:void 0,nodes:void 0,links:void 0},f={tree:void 0,data:void 0,nodes:void 0,links:void 0},h=function(r){t=d3.select(r).attr("id");var d=d3.select(r).append("div").style("width",s.layout.width()+"px").attr("class","tnt_groupDiv"),p=s.layout.cluster,g=f.tree.get_all_leaves().length,_=function(t){for(var e=0,n=t.get_all_leaves(),r=0;r<n.length;r++){var a=s.label.width()(n[r])+d3.functor(s.node_display.size())(n[r]);a>e&&(e=a)}return e},m=function(t){for(var e=0,n=t.get_all_leaves(),r=0;r<n.length;r++){var a=2*d3.functor(s.node_display.size())(n[r]),i=d3.functor(s.label.height())(n[r]);e=d3.max([e,a,i])}return e},y=_(f.tree);s.layout.max_leaf_label_width(y);var b=m(f.tree),x={n_leaves:g,label_height:b,label_padding:15};s.layout.adjust_cluster_size(x);var k=s.layout.diagonal(),w=s.layout.transform_node;e=d.append("svg").attr("width",s.layout.width()).attr("height",s.layout.height(x)+30).attr("fill","none"),n=e.append("g").attr("id","tnt_st_"+t).attr("transform","translate("+s.layout.translate_vis()[0]+","+s.layout.translate_vis()[1]+")"),f.nodes=p.nodes(f.data),s.layout.scale_branch_lengths(f),f.links=p.links(f.nodes),o=n.append("g").attr("class","links"),l=n.append("g").attr("class","nodes");var j=o.selectAll("path.tnt_tree_link").data(f.links,function(t){return s.id(t.target)});j.enter().append("path").attr("class","tnt_tree_link").attr("id",function(e){return"tnt_tree_link_"+t+"_"+s.id(e.target)}).style("stroke",function(t){return d3.functor(s.branch_color)(a(t.source),a(t.target))}).attr("d",k);var A=l.selectAll("g.tnt_tree_node").data(f.nodes,function(t){return s.id(t)}),z=A.enter().append("g").attr("class",function(t){return t.children?0===t.depth?"root tnt_tree_node":"inner tnt_tree_node":"leaf tnt_tree_node"}).attr("id",function(e){return"tnt_tree_node_"+t+"_"+e._id}).attr("transform",w);z.each(function(t){s.node_display.call(this,a(t))}),z.each(function(t){s.label.call(this,a(t),s.layout.type,d3.functor(s.node_display.size())(a(t)))}),z.on("click",function(t){var e=a(t);i.trigger("node:click",e),c.click.call(this,e)}),z.on("dblclick",function(t){var e=a(t);i.trigger("node:dblclick",e),c.dblclick.call(this,e)}),z.on("mouseover",function(t){var e=a(t);i.trigger("node:hover",a(t)),c.mouseover.call(this,e)}),z.on("mouseout",function(t){var e=a(t);i.trigger("node:mouseout",a(t)),c.mouseout.call(this,e)}),c.load(),v.method("update",function(){d.style("width",s.layout.width()+"px"),e.attr("width",s.layout.width());var r=s.layout.cluster,v=s.layout.diagonal(),p=s.layout.transform_node,g=_(f.tree);s.layout.max_leaf_label_width(g);var y=m(f.tree),b=f.tree.get_all_leaves().length,x={n_leaves:b,label_height:y,label_padding:15};s.layout.adjust_cluster_size(x),e.transition().duration(s.duration).ease(u).attr("height",s.layout.height(x)+30),n.transition().duration(s.duration).attr("transform","translate("+s.layout.translate_vis()[0]+","+s.layout.translate_vis()[1]+")"),f.nodes=r.nodes(f.data),s.layout.scale_branch_lengths(f),f.links=r.links(f.nodes);var k=o.selectAll("path.tnt_tree_link").data(f.links,function(t){return s.id(t.target)}),w=l.selectAll("g.tnt_tree_node").data(f.nodes,function(t){return s.id(t)});k.exit().remove();k.enter().append("path").attr("class","tnt_tree_link").attr("id",function(e){return"tnt_tree_link_"+t+"_"+s.id(e.target)}).attr("stroke",function(t){return d3.functor(s.branch_color)(a(t.source),a(t.target))}).attr("d",v),k.transition().ease(u).duration(s.duration).attr("d",v);var j=w.enter().append("g").attr("class",function(t){return t.children?0===t.depth?"root tnt_tree_node":"inner tnt_tree_node":"leaf tnt_tree_node"}).attr("id",function(e){return"tnt_tree_node_"+t+"_"+e._id}).attr("transform",p);w.exit().remove(),j.on("click",function(t){var e=a(t);i.trigger("node:click",e),c.click.call(this,e)}),j.on("dblclick",function(t){var e=a(t);i.trigger("node:dblclick",e),c.dblclick.call(this,e)}),j.on("mouseover",function(t){var e=a(t);i.trigger("node:hover",a(t)),c.mouseover.call(this,e)}),j.on("mouseout",function(t){var e=a(t);i.trigger("node:mouseout",a(t)),c.mouseout.call(this,e)}),h.update_nodes(),w.transition().ease(u).duration(s.duration).attr("transform",p)}),v.method("update_nodes",function(){var t=l.selectAll("g.tnt_tree_node");t.each(function(){s.node_display.reset.call(this)}),t.each(function(t){s.node_display.call(this,a(t))}),t.each(function(t){s.label.call(this,a(t),s.layout.type,d3.functor(s.node_display.size())(a(t)))})})},v=r(h).getset(s);return v.method("scale_bar",function(t,e){if(h.layout().scale()){e||(e="pixel");var n;return o.selectAll("path").each(function(r){if(!n){var a=this.getAttribute("d"),i=a.split(/[MLA]/),o=i.pop(),l=i.pop(),c=l.split(","),s=o.split(","),u=s[0]-c[0],d=s[1]-c[1],f=Math.sqrt(u*u+d*d),h=r.source,v=r.target,p=v._root_dist-h._root_dist;p&&("pixel"===e?n=p/f*t:"tree"===e&&(n=f/p*t))}}),n}}),v.method("data",function(t){if(!arguments.length)return d.data;d.data=t,f.data=t;var e=a(d.data);return h.root(e),d.tree=e,f.tree=d.tree,i.trigger("data:hasChanged",d.data),this}),v.method("root",function(){return f.tree}),d3.rebind(h,c,"on")};e.exports=n=i},{"tnt.api":6,"tnt.tree.node":18}],27:[function(t,e,n){e.exports=t("./src/index.js")},{"./src/index.js":28}],28:[function(t,e,n){var r=t("./utils.js");r.reduce=t("./reduce.js"),r.png=t("./png.js"),e.exports=n=r},{"./png.js":29,"./reduce.js":30,"./utils.js":31}],29:[function(t,e,n){var r=function(){var t,e='<?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">',n=1,r=function(){},a=function(a){a=a.node();var i=function(t){var e=d3.select(a).selectAll("image"),n=e[0].length;0===n&&t(),e.each(function(){var e=d3.select(this),r=new Image;r.onload=function(){var a=document.createElement("canvas"),i=a.getContext("2d");a.width=r.width,a.height=r.height,i.drawImage(r,0,0);var o=a.toDataURL("image/png");e.attr("href",o),n--,0===n&&t()},r.src=e.attr("href")})},o=function(t,e){for(var n=t.children||t.childNodes;n.length>0;){var r=n[0];1===r.nodeType&&e.appendChild(r)}return e},l=function(e){for(var n="",r=document.styleSheets,a=0;a<r.length;a++){var i=r[a].href||"";if(t){for(var o=!0,l=0;l<t.length;l++)if(i.indexOf(t[l])>-1){o=!1;break}if(o)continue}for(var c=r[a].cssRules||[],s=0;s<c.length;s++){var u=c[s];if("undefined"!=typeof u.style){var d=e.querySelectorAll(u.selectorText);d.length>0&&(n+=u.selectorText+" { "+u.style.cssText+" }\n")}}}var f=e.querySelector("defs")||document.createElement("defs"),h=document.createElement("style");return h.setAttribute("type","text/css"),h.innerHTML="<![CDATA[\n"+n+"\n]]>",f.appendChild(h),f};i(function(){var t=document.createElement("div"),i=a.cloneNode(!0),c=parseInt(i.getAttribute("width")),s=parseInt(i.getAttribute("height"));i.setAttribute("version","1.1"),i.setAttribute("xmlns","http://www.w3.org/2000/svg"),i.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),i.setAttribute("width",c*n),i.setAttribute("height",s*n);var u=document.createElement("g");u.setAttribute("transform","scale("+n+")"),i.appendChild(o(i,u)),t.appendChild(i),i.insertBefore(l(i),i.firstChild);var d=e+t.innerHTML;d=d.replace("none","block");var f=new Image;f.src="data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(d))),f.onload=function(){var t=document.createElement("canvas");t.width=f.width,t.height=f.height;var e=t.getContext("2d");e.drawImage(f,0,0);var n=t.toDataURL("image/png");r(n)}})};return a.scale_factor=function(t){return arguments.length?(n=t,this):n},a.callback=function(t){return arguments.length?(r=t,this):r},a.stylesheets=function(e){return arguments.length?(t=e,this):t},a},a=function(){var t="image.png",e={limit:1/0,onError:function(){console.log("image too large")}},n=r().callback(function(n){var r=document.createElement("a");r.download=t,r.href=n,document.body.appendChild(r),r.href.length>e.limit?(r.parentNode.removeChild(r),e.onError()):r.click()});return n.filename=function(e){return arguments.length?(t=e,n):t},n.limit=function(t){return arguments.length?(e=t,this):e},n};e.exports=n=a},{}],30:[function(t,e,n){var r=function(){var t=5,e="val",n=function(t,e){return t<e?e-t<=.2*e:t-e<=.2*t},r=function(t){return t},a=function(t){if(!t.length)return t;var e=l(t),n=r(e);return n},i=function(t,n){if(n.sort(function(t,n){return t[e]-n[e]}),n.length%2)t[e]=n[~~(n.length/2)][e];else{var r=~~(n.length/2)-1;t[e]=(n[r][e]+n[r+1][e])/2}return t},o=function(t){var e={};for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},l=function(e){if(0===t)return e;for(var n=[],r=0;r<e.length;r++){var a=r<t?0:r-t,l=r>e.length-t?e.length:r+t;n[r]=i(o(e[r]),e.slice(a,l+1))}return n};return a.reducer=function(t){return arguments.length?(r=t,a):r},a.redundant=function(t){return arguments.length?(n=t,a):n},a.value=function(t){return arguments.length?(e=t,a):e},a.smooth=function(e){return arguments.length?(t=e,a):t},a},a=function(){var t=r().value("start"),e="end",n=function(n,r){return{object:{start:n.object[t.value()],end:r[e]},value:r[e]}};return t.reducer(function(r){for(var a=t.value(),i=t.redundant(),o=[],l={object:r[0],value:r[0][e]},c=1;c<r.length;c++)i(r[c][a],l.value)?l=n(l,r[c]):(o.push(l.object),l.object=r[c],l.value=r[c].end);return o.push(l.object),o}),r.join=function(e){return arguments.length?(n=e,t):n},r.value2=function(n){return arguments.length?(e=n,t):e},t},i=function(){var t=r();return t.reducer(function(e){for(var n=t.redundant(),r=t.value(),a=[],i=e[0],o=1;o<e.length-1;o++)n(e[o][r],i[r])||(a.push(i),i=e[o]);return a.push(i),a.push(e[e.length-1]),a}),t};e.exports=r,e.exports.line=i,e.exports.block=a},{}],31:[function(t,e,n){e.exports={iterator:function(t){var e=t||0,n=function(){return e++};return n},script_path:function(t){var e=t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),n=new RegExp(e+"$"),r=new RegExp("(.*)"+e+"$"),a=document.getElementsByTagName("script"),i="";if(void 0!==a)for(var o in a)if(a[o].src&&a[o].src.match(n))return a[o].src.replace(r,"$1");return i},defer_cancel:function(t,e){var n,r=function(){var r=Array.prototype.slice.call(arguments),a=this;clearTimeout(n),n=setTimeout(function(){t.apply(a,r)},e)};return r}}},{}],32:[function(t,e,n){var r=t("tnt.api"),a=function(){"use strict";var t,e=!0,n={tree:void 0,track:function(){var t=tnt.board.track().color("#EBF5FF").data(tnt.board.track.data().update(tnt.board.track.retriever.sync().retriever(function(){return[]}))).display(tnt.board.track.feature.block().color("steelblue").index(function(t){return t.start}));return t},board:void 0,ruler:"none",key:void 0},a=function(e){t=d3.select(e).attr("id");var r=d3.select(e).append("div").attr("class","tnt_groupDiv"),o=r.append("div").attr("id","tnt_tree_container_"+t).attr("class","tnt_tree_container"),l=r.append("div").attr("id","tnt_annot_container_"+t).attr("class","tnt_annot_container");n.tree(o.node());for(var c=n.tree.root().get_all_leaves(),s=[],u=n.tree.label().height(),d=0;d<c.length;d++)!function(t){tnt.board.track.id=function(){return void 0===n.key?t.id():"function"==typeof n.key?n.key(t):t.property(n.key)};var e=n.track(c[d]).height(u);s.push(e)}(c[d]);tnt.board.track.id=function(){return"axis-top"};var f=tnt.board.track().height(0).color("white").display(tnt.board.track.feature.axis().orientation("top"));tnt.board.track.id=function(){return"axis-bottom"};var h=tnt.board.track().height(18).color("white").display(tnt.board.track.feature.axis().orientation("bottom"));return n.board&&("both"!==n.ruler&&"top"!==n.ruler||n.board.add_track(f),n.board.add_track(s),"both"!==n.ruler&&"bottom"!==n.ruler||n.board.add_track(h),n.board(l.node()),n.board.start()),i.method("update",function(){if(n.tree.update(),n.board){var t=n.tree.root().get_all_leaves(),e=[];"both"!==n.ruler&&"top"!==n.ruler||e.push(f);for(var r=0;r<t.length;r++){var a;a=void 0===n.key?t[r].id():"function"==typeof n.key?n.key(t[r]):t[r].property(n.key);var i=n.board.find_track(a);void 0===i&&!function(e){tnt.board.track.id=function(){return void 0===n.key?e.id():"function"==typeof n.key?n.key(e):e.property(n.key)},i=n.track(t[r]).height(u)}(t[r]),e.push(i)}"both"!==n.ruler&&"bottom"!==n.ruler||e.push(h),n.board.tracks(e)}}),a},i=r(a).getset(n);return a.track=function(t){if(!arguments.length)return n.track;if(e)return n.track=t,e=!1,a;var r=n.board.tracks(),i=0,o=0;if("both"===n.ruler?(i=1,o=2):"top"===n.ruler?(i=1,o=1):"bottom"===n.ruler&&(o=1),i>0&&r[0].display().reset.call(r[0]),o>i){var l=r.length-1;r[l].display().reset.call(r[l])}for(var c=i;c<=r.length-o;c++){var s=r[c];s.display().reset.call(s);var u;n.tree.root().apply(function(t){t.id()===s.id()&&(u=t)});var d;!function(e){tnt.board.track.id=function(){return void 0===n.key?e.id():n.key(e)},d=t(e).height(n.tree.label().height())}(u),r[c]=d}n.track=t,n.board.start()},a};e.exports=n=a},{"tnt.api":6}]},{},[1]);